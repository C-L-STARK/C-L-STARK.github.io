
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="FastDoc is a website that you can get started with FastX AI in minutes.">
      
      
      
        <link rel="canonical" href="https://doc.fastx-ai.com/ml/1_58_llm_extreme_quantization/">
      
      
        <link rel="prev" href="../../big-data/">
      
      
        <link rel="next" href="../2023-in-llms/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>Fine-tuning LLMs to 1.58bit: extreme quantization made easy - FastDocs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XXXXXXXXXX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Fine-tuning LLMs to 1.58bit: extreme quantization made easy - FastDocs" >
      
        <meta  property="og:description"  content="FastDoc is a website that you can get started with FastX AI in minutes." >
      
        <meta  property="og:image"  content="https://doc.fastx-ai.com/assets/images/social/ml/1_58_llm_extreme_quantization.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://doc.fastx-ai.com/ml/1_58_llm_extreme_quantization/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Fine-tuning LLMs to 1.58bit: extreme quantization made easy - FastDocs" >
      
        <meta  name="twitter:description"  content="FastDoc is a website that you can get started with FastX AI in minutes." >
      
        <meta  name="twitter:image"  content="https://doc.fastx-ai.com/assets/images/social/ml/1_58_llm_extreme_quantization.png" >
      
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#llms-158" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
<p style="text-align: center">
  Welcome to <span style="font-size: bold">FastDocs</span>! Just feel free to start read docs!
</p>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="FastDocs" class="md-header__button md-logo" aria-label="FastDocs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FastDocs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Fine-tuning LLMs to 1.58bit: extreme quantization made easy
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/C-L-STARK/C-L-STARK.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    C-L-STARK/C-L-STARK.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  ä¸»é¡µ

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../backend/" class="md-tabs__link">
        
  
    
  
  åç«¯

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../web/" class="md-tabs__link">
        
  
    
  
  å‰ç«¯

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../client/" class="md-tabs__link">
        
  
    
  
  å®¢æˆ·ç«¯

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pc/" class="md-tabs__link">
        
  
    
  
  æ¡Œé¢ç«¯

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../big-data/" class="md-tabs__link">
        
  
    
  
  å¤§æ•°æ®

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
    
  
  äººå·¥æ™ºèƒ½

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../ops/" class="md-tabs__link">
        
  
    
  
  è¿ç»´

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../blog/" class="md-tabs__link">
          
  
    
  
  åšå®¢

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../resume/" class="md-tabs__link">
        
  
    
  
  ç®€å†æ¨¡æ¿

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="FastDocs" class="md-nav__button md-logo" aria-label="FastDocs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FastDocs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/C-L-STARK/C-L-STARK.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    C-L-STARK/C-L-STARK.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸»é¡µ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åç«¯
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å‰ç«¯
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å®¢æˆ·ç«¯
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¡Œé¢ç«¯
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../big-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¤§æ•°æ®
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    äººå·¥æ™ºèƒ½
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            äººå·¥æ™ºèƒ½
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Fine-tuning LLMs to 1.58bit: extreme quantization made easy
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Fine-tuning LLMs to 1.58bit: extreme quantization made easy
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      ç›®å½•
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      ç®€ä»‹
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç®€ä»‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#transformers" class="md-nav__link">
    <span class="md-ellipsis">
      å¦‚ä½•åœ¨ Transformers ä¸­ä½¿ç”¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bitnet" class="md-nav__link">
    <span class="md-ellipsis">
      æ›´æ·±å…¥åœ°äº†è§£ä»€ä¹ˆæ˜¯BitNet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æ›´æ·±å…¥åœ°äº†è§£ä»€ä¹ˆæ˜¯BitNet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      è®­ç»ƒ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      æ¨ç†
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#158" class="md-nav__link">
    <span class="md-ellipsis">
      1.58æ¯”ç‰¹çš„é¢„è®­ç»ƒç»“æœ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#158_1" class="md-nav__link">
    <span class="md-ellipsis">
      1.58æ¯”ç‰¹çš„å¾®è°ƒ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.58æ¯”ç‰¹çš„å¾®è°ƒ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#100btoken" class="md-nav__link">
    <span class="md-ellipsis">
      æ‰©å±•åˆ°100Bä¸ªtoken!
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      åœ¨æ›´å°çš„æ¨¡å‹ä¸Šçš„å®éªŒ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      å¯¹æ¯”ä¸ç»“è®º
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨çš„ç®—å­å’Œæµ‹è¯•æ ‡å‡†
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ä½¿ç”¨çš„ç®—å­å’Œæµ‹è¯•æ ‡å‡†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gpu" class="md-nav__link">
    <span class="md-ellipsis">
      åŸºç¡€çš„GPUæ¦‚å¿µ: çº¿ç¨‹, å—, å’Œå…±äº«å†…å­˜
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      çŸ©é˜µä¹˜æ³•ä¸­çš„æŒ‘æˆ˜
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      åˆ†å—çš„æ¦‚å¿µ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#triton" class="md-nav__link">
    <span class="md-ellipsis">
      Tritonç®—å­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ä»£ç è§£æ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      åŸºå‡†æµ‹è¯•
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      ç»“è®º
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      è‡´è°¢
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      æ›´å¤šèµ„æº
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2023-in-llms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023, å¼€æºå¤§æ¨¡å‹ä¹‹å¹´
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3d-assets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨äººå·¥æ™ºèƒ½ç”Ÿæˆ 3D ç´ æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4bit-transformers-bitsandbytes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç”¨ bitsandbytesã€4 æ¯”ç‰¹é‡åŒ–å’Œ QLoRA æ‰“é€ äº²æ°‘çš„ LLM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Llama2-for-non-engineers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    éå·¥ç¨‹å¸ˆæŒ‡å—ï¼šè®­ç»ƒ LLaMA 2 èŠå¤©æœºå™¨äºº
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lora-for-sequence-classification-with-Roberta-Llama-Mistral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨ç¾éš¾æ¨æ–‡åˆ†æåœºæ™¯ä¸Šæ¯”è¾ƒç”¨ LoRA å¾®è°ƒ Robertaã€Llama 2 å’Œ Mistral çš„è¿‡ç¨‹åŠè¡¨ç°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../_policy-ntia-rfc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    äººå·¥æ™ºèƒ½æ”¿ç­–@ğŸ¤—ï¼šå›åº”ç¾å›½å›½å®¶ç”µä¿¡å’Œä¿¡æ¯ç®¡ç†å±€ï¼ˆ NTIA ï¼‰å…³äºäººå·¥æ™ºèƒ½é—®è´£åˆ¶çš„è¯„è®ºè¯·æ±‚
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accelerate-v1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accelerate 1.0.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accelerated-inference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¦‚ä½•æˆåŠŸå°† ğŸ¤— API å®¢æˆ·çš„ transformer æ¨¡å‹æ¨ç†é€Ÿåº¦åŠ å¿« 100 å€
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æˆæƒè°ƒç”¨ï¼šä»‹ç» Transformers æ™ºèƒ½ä½“ 2.0  
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aivsai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI å¤§æˆ˜ AIï¼Œä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ å¤šæ™ºèƒ½ä½“ç«èµ›ç³»ç»Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arena-tts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TTS æ“‚å°: æ–‡æœ¬è½¬è¯­éŸ³æ¨¡å‹çš„è‡ªç”±æå‡»åœº
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../asr-diarization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ Hugging Face æ¨ç†ç»ˆç«¯æ­å»ºå¼ºå¤§çš„â€œè¯­éŸ³è¯†åˆ« + è¯´è¯äººåˆ†å‰² + æŠ•æœºè§£ç â€å·¥ä½œæµ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assisted-generation-support-gaudi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è‹±ç‰¹å°” Gaudi åŠ é€Ÿè¾…åŠ©ç”Ÿæˆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assisted-generation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è¾…åŠ©ç”Ÿæˆï¼šä½å»¶è¿Ÿæ–‡æœ¬ç”Ÿæˆçš„æ–°æ–¹å‘
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../audioldm2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AudioLDM 2ï¼ŒåŠ é€Ÿâš¡ï¸ï¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../autoformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer æ¨¡å‹èƒ½å¤Ÿæœ‰æ•ˆåœ°è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹ (ä½¿ç”¨ Autoformer)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../beating-gaia/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformers ä»£ç æ™ºèƒ½ä½“æˆåŠŸåˆ·æ¦œ GAIA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../big-bird/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ·±å…¥ç†è§£ BigBird çš„å—ç¨€ç–æ³¨æ„åŠ›
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blip-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ BLIP-2 é›¶æ ·æœ¬â€œå›¾ç”Ÿæ–‡â€
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bloom-inference-optimization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¼˜åŒ–æ•…äº‹: BLOOM æ¨¡å‹æ¨ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bloom-inference-pytorch-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ DeepSpeed å’Œ Accelerate è¿›è¡Œè¶…å¿« BLOOM æ¨¡å‹æ¨ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bloom-megatron-deepspeed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åƒäº¿å‚æ•°å¼€æºå¤§æ¨¡å‹ BLOOM èƒŒåçš„æŠ€æœ¯
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bridgetower/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ Habana Gaudi2 åŠ é€Ÿè§†è§‰è¯­è¨€æ¨¡å‹ BridgeTower
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chat-templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    èŠå¤©æ¨¡æ¿ï¼šæ— å£°æ€§èƒ½æ€æ‰‹çš„ç»ˆç»“
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chinese-ai-expansion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸­å›½ AI å‡ºæµ·ç°çŠ¶æ¦‚è¿°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chinese-language-blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face ä¸­æ–‡åšå®¢æ­£å¼å‘å¸ƒï¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloudflare-workers-ai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸º Hugging Face ç”¨æˆ·å¸¦æ¥æ— æœåŠ¡å™¨ GPU æ¨ç†æœåŠ¡
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../codellama/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Llamaï¼šLlama 2 å­¦ä¼šå†™ä»£ç äº†ï¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../community-datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ•°æ®å¥½åˆï¼šArgilla å’Œ Hugging Face Spaces èµ‹èƒ½ç¤¾åŒºåˆåŠ›æ„å»ºæ›´å¥½çš„æ•°æ®é›†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constrained-beam-search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨ ğŸ¤— Transformers ä¸­ä½¿ç”¨çº¦æŸæ³¢æŸæœç´¢å¼•å¯¼æ–‡æœ¬ç”Ÿæˆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../controlnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ ğŸ§¨ Diffusers å®ç° ControlNet é«˜é€Ÿæ¨ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cosmopedia/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cosmopediaï¼šå¦‚ä½•ä¸ºå¤§è¯­è¨€æ¨¡å‹é¢„è®­ç»ƒæ„å»ºå¤§è§„æ¨¡åˆæˆæ•°æ®é›†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cost-efficient-rag-applications-with-intel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åˆ©ç”¨è‹±ç‰¹å°” Gaudi 2 å’Œè‡³å¼º CPU æ„å»ºç»æµé«˜æ•ˆçš„ä¼ä¸šçº§ RAG åº”ç”¨
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cv_state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face ä¸­è®¡ç®—æœºè§†è§‰çš„ç°çŠ¶
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../daily-papers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face è®ºæ–‡å¹³å° Daily Papers åŠŸèƒ½å…¨è§£æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dedup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BigCode èƒŒåçš„å¤§è§„æ¨¡æ•°æ®å»é‡
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deep-learning-with-proteins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è›‹ç™½è´¨æ·±åº¦å­¦ä¹ 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deepspeed-to-fsdp-and-back/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä» DeepSpeed åˆ° FSDPï¼Œå†å›åˆ° Hugging Face Accelerate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deploy-deepfloydif-using-bentoml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ BentoML éƒ¨ç½² ğŸ¤— Hugging Face ä¸Šçš„æ¨¡å‹ï¼šDeepFloyd IF å®æˆ˜
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deploy-with-openvino/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ Optimum-Intel å’Œ OpenVINO GenAI ä¼˜åŒ–å’Œéƒ¨ç½²æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dialog-agents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ˜¯ä»€ä¹ˆè®©å¯¹è¯ä»£ç†æœ‰ç”¨ï¼Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../diffusers-turns-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ¤— Diffusers ä¸€å²å•¦ !
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docmatix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docmatix - è¶…å¤§æ–‡æ¡£è§†è§‰é—®ç­”æ•°æ®é›†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../document-ai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åŠ é€Ÿ Document AI (æ–‡æ¡£æ™ºèƒ½) å‘å±•
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dpo-trl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ DPO å¾®è°ƒ Llama 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dpo_vlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸ºè§†è§‰è¯­è¨€å¤šæ¨¡æ€æ¨¡å‹è¿›è¡Œåå¥½ä¼˜åŒ–
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dreambooth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ Diffusers é€šè¿‡ Dreambooth æŠ€æœ¯æ¥è®­ç»ƒ Stable Diffusion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_speculation_lookahead/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ›´å¿«çš„è¾…åŠ©ç”Ÿæˆ: åŠ¨æ€æ¨æµ‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../elixir-bumblebee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä» GPT2 åˆ° Stable Diffusionï¼šElixir ç¤¾åŒºè¿æ¥äº† Hugging Face
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../embedding-quantization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç”¨äºæ˜¾è‘—æé«˜æ£€ç´¢é€Ÿåº¦å’Œé™ä½æˆæœ¬çš„äºŒè¿›åˆ¶å’Œæ ‡é‡åµŒå…¥é‡åŒ–
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encoder-decoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åŸºäº Transformers çš„ç¼–ç å™¨-è§£ç å™¨æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encrypted-llm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ FHE å®ç°åŠ å¯†å¤§è¯­è¨€æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ethics-diffusers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¼€å‘ Diffusers åº“çš„é“å¾·è¡Œä¸ºæŒ‡å—
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ethics-soc-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é“å¾·ä¸ç¤¾ä¼šé—®é¢˜ç®€æŠ¥ #3: Hugging Face ä¸Šçš„é“å¾·å¼€æ”¾æ€§
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ethics-soc-4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ethics and Society Newsletter #4: Bias in Text-to-Image Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../falcon-180b/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Falcon 180B ç™»é™† Hugging Face Hub ğŸ”¥
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../falcon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Falcon ç™»é™† Hugging Face ç”Ÿæ€
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../falconmamba/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Falcon Mamba: é¦–ä¸ªé«˜æ•ˆçš„æ— æ³¨æ„åŠ›æœºåˆ¶ 7B æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fine-tune-whisper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ ğŸ¤— Transformers ä¸ºå¤šè¯­ç§è¯­éŸ³è¯†åˆ«ä»»åŠ¡å¾®è°ƒ Whisper æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fine-video/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ­ç§˜ FineVideo æ•°æ®é›†æ„å»ºçš„èƒŒåçš„ç§˜å¯†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../finetune-florence2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¾®è°ƒ Florence-2 - å¾®è½¯çš„å°–ç«¯è§†è§‰è¯­è¨€æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game-jam-first-edition-results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é¦–å±Šå¼€æº AI æ¸¸æˆæŒ‘æˆ˜èµ›äº‹ç»“æœ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gaussian-splatting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3D é«˜æ–¯ç‚¹æŸ“ç®€ä»‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gemma-july-update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Google æœ€æ–°å‘å¸ƒï¼š Gemma 2 2B, ShieldGemma å’Œ Gemma Scope
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gemma-peft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ Hugging Face å¾®è°ƒ Gemma æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gemma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¬¢è¿ Gemma: Google æœ€æ–°æ¨å‡ºå¼€æ”¾å¤§è¯­è¨€æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gemma2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Google å‘å¸ƒæœ€æ–°å¼€æ”¾å¤§è¯­è¨€æ¨¡å‹ Gemma 2ï¼Œç°å·²ç™»é™† Hugging Face Hub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generative-ai-models-on-intel-cpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è¶Šå°è¶Šå¥½ï¼šQ8-Chatï¼Œåœ¨è‹±ç‰¹å°”è‡³å¼º CPU ä¸Šä½“éªŒé«˜æ•ˆçš„ç”Ÿæˆå¼ AI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started-habana/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åŸºäº Habana Gaudi çš„ Transformers å…¥é—¨
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../google-cloud-model-garden/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨ Google Cloud ä¸Šè½»æ¾éƒ¨ç½²å¼€æ”¾å¤§è¯­è¨€æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gptq-integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ AutoGPTQ å’Œ transformers è®©å¤§è¯­è¨€æ¨¡å‹æ›´è½»é‡åŒ–
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gradio-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gradio 5 ç°å·²å‘å¸ƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gradio-lite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gradio-Lite: å®Œå…¨åœ¨æµè§ˆå™¨é‡Œè¿è¡Œçš„æ— æœåŠ¡å™¨ Gradio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gradio-reload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ Gradio çš„â€œçƒ­é‡è½½â€æ¨¡å¼å¿«é€Ÿå¼€å‘ AI åº”ç”¨
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphml-classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ Transformers è¿›è¡Œå›¾åˆ†ç±»
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../habana-gaudi-2-benchmark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ›´å¿«çš„è®­ç»ƒå’Œæ¨ç†ï¼šå¯¹æ¯” Habana GaudiÂ®2 å’Œè‹±ä¼Ÿè¾¾ A100 80GB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../habana-gaudi-2-bloom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¤§è¯­è¨€æ¨¡å‹å¿«é€Ÿæ¨ç†ï¼šåœ¨ Habana Gaudi2 ä¸Šæ¨ç† BLOOMZ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hf-bitsandbytes-integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¤§è§„æ¨¡ Transformer æ¨¡å‹ 8 æ¯”ç‰¹çŸ©é˜µä¹˜ç®€ä»‹ - åŸºäº Hugging Face Transformersã€Accelerate ä»¥åŠ bitsandbytes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-generate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¦‚ä½•ç”Ÿæˆæ–‡æœ¬ï¼šé€šè¿‡ Transformers ç”¨ä¸åŒçš„è§£ç æ–¹æ³•ç”Ÿæˆæ–‡æœ¬
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hugging-face-wiz-security-blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face ä¸ Wiz Research åˆä½œæé«˜äººå·¥æ™ºèƒ½å®‰å…¨æ€§
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../huggy-lingo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Huggy Lingoï¼šåˆ©ç”¨æœºå™¨å­¦ä¹ æ”¹è¿› Hugging Face Hub ä¸Šçš„è¯­è¨€å…ƒæ•°æ®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../idefics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IDEFICS ç®€ä»‹ï¼šæœ€å…ˆè¿›è§†è§‰è¯­è¨€æ¨¡å‹çš„å¼€æºå¤ç°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../idefics2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Idefics2 ç®€ä»‹ï¼šä¸ºç¤¾åŒºè€Œç”Ÿçš„å¼ºå¤§ 8B è§†è§‰è¯­è¨€æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../if/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨å…è´¹ç‰ˆ Google Colab ä¸Šä½¿ç”¨ ğŸ§¨ diffusers è¿è¡Œ IF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image-similarity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åŸºäº Hugging Face Datasets å’Œ Transformers çš„å›¾åƒç›¸ä¼¼æ€§æœç´¢
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inference-endpoints-llm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç”¨ Hugging Face æ¨ç†ç«¯ç‚¹éƒ¨ç½² LLM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inference-update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face æä¾›çš„æ¨ç†ï¼ˆInferenceï¼‰è§£å†³æ–¹æ¡ˆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../infini-attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸€æ¬¡å¤±è´¥çš„å®éªŒâ€”â€”æ— é™æ³¨æ„åŠ›ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆåšæŒå®éªŒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../informer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ Informer è¿›è¡Œå¤šå…ƒæ¦‚ç‡æ—¶é—´åºåˆ—é¢„æµ‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../instruction-tuning-sd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ InstructPix2Pix å¯¹ Stable Diffusion è¿›è¡ŒæŒ‡ä»¤å¾®è°ƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intel-fast-embedding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åˆ©ç”¨ ğŸ¤— Optimum Intel å’Œ fastRAG åœ¨ CPU ä¸Šä¼˜åŒ–æ–‡æœ¬åµŒå…¥
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intel-protein-language-model-protst/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨è‹±ç‰¹å°” Gaudi 2 ä¸ŠåŠ é€Ÿè›‹ç™½è´¨è¯­è¨€æ¨¡å‹ ProtST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intel-sapphire-rapids-inference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CPU æ¨ç† | ä½¿ç”¨è‹±ç‰¹å°” Sapphire Rapids åŠ é€Ÿ PyTorch Transformers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intel-sapphire-rapids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨è‹±ç‰¹å°” Sapphire Rapids åŠ é€Ÿ PyTorch Transformers æ¨¡å‹ï¼ˆç¬¬ä¸€éƒ¨åˆ†ï¼‰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intel-starcoder-quantization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ ğŸ¤— Optimum Intel åœ¨è‹±ç‰¹å°”è‡³å¼ºä¸ŠåŠ é€Ÿ StarCoderï¼šQ8/Q4 åŠæŠ•æœºè§£ç 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro-graphml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸€æ–‡å¸¦ä½ å…¥é—¨å›¾æœºå™¨å­¦ä¹ 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introducing-csearch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨ Transformers ä¸­ä½¿ç”¨å¯¹æ¯”æœç´¢ç”Ÿæˆå¯åª²ç¾äººç±»æ°´å¹³çš„æ–‡æœ¬ğŸ¤—
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-to-ggml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ggml ç®€ä»‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸‡äº‹é€šï¼Œä¸“ç²¾éƒ¨åˆ†é¢†åŸŸçš„å¤šåŠŸèƒ½ Transformer æ™ºèƒ½ä½“
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kv-cache-quantization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç”¨ KV ç¼“å­˜é‡åŒ–è§£é”é•¿æ–‡æœ¬ç”Ÿæˆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../langchain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face x LangChainï¼šå…¨æ–° LangChain åˆä½œä¼™ä¼´åŒ…
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../large-language-models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¤§è¯­è¨€æ¨¡å‹ï¼šæ–°çš„æ‘©å°”å®šå¾‹ï¼Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lcm_lora/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ LCM LoRA 4 æ­¥å®Œæˆ SDXL æ¨ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../leaderboard-bigcodebench/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BigCodeBench: ç»§ HumanEval ä¹‹åçš„æ–°ä¸€ä»£ä»£ç ç”ŸæˆåŸºå‡†æµ‹è¯•
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../leaderboard-decodingtrust/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¥è‡ª AI Secure å®éªŒå®¤çš„ LLM å®‰å…¨æ’è¡Œæ¦œç®€ä»‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../leaderboard-medicalllm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¼€æºåŒ»ç–—å¤§æ¨¡å‹æ’è¡Œæ¦œï¼šå¥åº·é¢†åŸŸå¤§æ¨¡å‹åŸºå‡†æµ‹è¯•
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../leaderboard-patronus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¼ä¸šåœºæ™¯æ’è¡Œæ¦œç®€ä»‹ï¼šç°å®ä¸–ç•Œç”¨ä¾‹æ’è¡Œæ¦œ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llama2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama 2 æ¥è¢­ - åœ¨ Hugging Face ä¸Šç©è½¬å®ƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llama3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¬¢è¿ Llama 3ï¼šMeta çš„æ–°ä¸€ä»£å¼€æºå¤§è¯­è¨€æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llama31/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama 3.1ï¼š405B/70B/8B æ¨¡å‹çš„å¤šè¯­è¨€ä¸é•¿ä¸Šä¸‹æ–‡èƒ½åŠ›è§£æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llama32/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç°åœ¨ Llama å…·å¤‡è§†è§‰èƒ½åŠ›å¹¶å¯ä»¥åœ¨ä½ çš„è®¾å¤‡ä¸Šè¿è¡Œ - æ¬¢è¿ä½¿ç”¨ Llama 3.2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../long-range-transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é•¿ç¨‹ transformer æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lora/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ LoRA è¿›è¡Œ Stable Diffusion çš„é«˜æ•ˆå‚æ•°å¾®è°ƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mask2former/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é€šç”¨å›¾åƒåˆ†å‰²ä»»åŠ¡ï¼šä½¿ç”¨ Mask2Former å’Œ OneFormer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../matryoshka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸª† ä¿„ç½—æ–¯å¥—å¨ƒåµŒå…¥æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../megatron-training/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¦‚ä½•ä½¿ç”¨ Megatron-LM è®­ç»ƒè¯­è¨€æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mixtral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¬¢è¿ Mixtral - å½“å‰ Hugging Face ä¸Šæœ€å…ˆè¿›çš„ MoE æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml-for-games-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åŸºäºAIè¿›è¡Œæ¸¸æˆå¼€å‘ï¼š5å¤©ï¼åˆ›å»ºä¸€ä¸ªå†œåœºæ¸¸æˆï¼ç¬¬1éƒ¨åˆ†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml-for-games-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ ChatGPT å¯å‘æ¸¸æˆåˆ›æ„ï½œåŸºäº AI 5 å¤©åˆ›å»ºä¸€ä¸ªå†œåœºæ¸¸æˆï¼Œç¬¬ 2 å¤©
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml-for-games-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI åˆ¶ä½œ 3D ç´ æï½œåŸºäº AI 5 å¤©åˆ›å»ºä¸€ä¸ªå†œåœºæ¸¸æˆï¼Œç¬¬ 3 å¤©
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml-for-games-4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åˆ¶ä½œ 2D ç´ æï½œåŸºäº AI 5 å¤©åˆ›å»ºä¸€ä¸ªå†œåœºæ¸¸æˆï¼Œç¬¬ 4 å¤©
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml-for-games-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ChatGPT è®¾è®¡æ¸¸æˆå‰§æƒ… | åŸºäº AI 5 å¤©åˆ›å»ºä¸€ä¸ªå†œåœºæ¸¸æˆï¼Œå®Œç»“ç¯‡ï¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mms_adapters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¾®è°ƒç”¨äºå¤šè¯­è¨€ ASR çš„ MMS é€‚é…å™¨æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../moe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ··åˆä¸“å®¶æ¨¡å‹ï¼ˆMoEï¼‰è¯¦è§£
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-lora-serving/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TGI å¤š-LoRAï¼šéƒ¨ç½²ä¸€æ¬¡ï¼Œæå®š 30 ä¸ªæ¨¡å‹çš„æ¨ç†æœåŠ¡
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../noob_intro_transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face Transformers èŒæ–°å®Œå…¨æŒ‡å—
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../open-llm-leaderboard-drop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¼€æ”¾ LLM æ’è¡Œæ¦œï¼šæ·±å…¥ç ”ç©¶ DROP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../open-llm-leaderboard-mmlu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Open LLM æ’è¡Œæ¦œè¿‘å†µ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../open-llm-leaderboard-rlhf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åŸºç¡€å¤§æ¨¡å‹èƒ½åƒäººç±»ä¸€æ ·æ ‡æ³¨æ•°æ®å—ï¼Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../open-source-llms-as-agents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¼€æºå¤§è¯­è¨€æ¨¡å‹ä½œä¸º LangChain æ™ºèƒ½ä½“
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimize-llm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é¢å‘ç”Ÿäº§çš„ LLM ä¼˜åŒ–
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimizing-bark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ ğŸ¤— Transformers ä¼˜åŒ– Bark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimum-onnxruntime-training/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimum + ONNX Runtime: æ›´å®¹æ˜“ã€æ›´å¿«åœ°è®­ç»ƒä½ çš„ Hugging Face æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../os-llms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face çš„æ–‡æœ¬ç”Ÿæˆå’Œå¤§è¯­è¨€æ¨¡å‹çš„å¼€æºç”Ÿæ€
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview-quantization-transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ¤— Transformers ä¸­åŸç”Ÿæ”¯æŒçš„é‡åŒ–æ–¹æ¡ˆæ¦‚è¿°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../packing-with-FA2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é€šè¿‡æ‰“åŒ… Flash Attention æ¥æå‡ Hugging Face è®­ç»ƒæ•ˆç‡
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paligemma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PaliGemma æ­£å¼å‘å¸ƒ â€” Google æœ€æ–°å‘å¸ƒçš„å‰æ²¿å¼€æ”¾è§†è§‰è¯­è¨€æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../password-git-deprecation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hub ä¸Šçš„ Git æ“ä½œä¸å†æ”¯æŒä½¿ç”¨å¯†ç éªŒè¯
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../peft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ¤— PEFTï¼šåœ¨ä½èµ„æºç¡¬ä»¶ä¸Šå¯¹åäº¿è§„æ¨¡æ¨¡å‹è¿›è¡Œå‚æ•°é«˜æ•ˆå¾®è°ƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../personal-copilot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸ªäººç¼–ç¨‹åŠ©æ‰‹ï¼šè®­ç»ƒä½ è‡ªå·±çš„ç¼–ç åŠ©æ‰‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phi2-intel-meteor-lake/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬”è®°æœ¬ç”µè„‘ä¸Šçš„èŠå¤©æœºå™¨äººï¼šåœ¨è‹±ç‰¹å°” Meteor Lake ä¸Šè¿è¡Œ Phi-2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../presidio-pii-detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨ Hub ä¸Šä½¿ç”¨ Presidio è¿›è¡Œè‡ªåŠ¨ PII æ£€æµ‹å®éªŒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../putting_rl_back_in_rlhf_with_rloo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å°†å¼ºåŒ–å­¦ä¹ é‡æ–°å¼•å…¥ RLHF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pycharm-integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face ä¸ PyCharm æ·±åº¦é›†æˆï¼šè½»æ¾å¼•å…¥ä¸°å¯Œçš„ AI æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch-ddp-accelerate-transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä» PyTorch DDP åˆ° Accelerate åˆ° Trainerï¼Œè½»æ¾æŒæ¡åˆ†å¸ƒå¼è®­ç»ƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch-fsdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ PyTorch å®Œå…¨åˆ†ç‰‡æ•°æ®å¹¶è¡ŒæŠ€æœ¯åŠ é€Ÿå¤§æ¨¡å‹è®­ç»ƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quanto-diffusers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åŸºäº Quanto å’Œ Diffusers çš„å†…å­˜é«˜æ•ˆ transformer æ‰©æ•£æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quanto-introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantoï¼šPyTorch é‡åŒ–å·¥å…·åŒ…
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ram-efficient-pytorch-fsdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ PyTorch FSDP å¾®è°ƒ Llama 2 70B
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../red-teaming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸ºå¤§è¯­è¨€æ¨¡å‹å»ºç«‹çº¢é˜Ÿå¯¹æŠ—
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reformer æ¨¡å‹ - çªç ´è¯­è¨€å»ºæ¨¡çš„æé™
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HF Hub ç°å·²åŠ å…¥å­˜å‚¨åŒºåŸŸåŠŸèƒ½
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../researcher-dataset-sharing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨ Hugging Face Hub åˆ†äº«ä½ çš„å¼€æºæ•°æ®é›†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rlhf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ChatGPT èƒŒåçš„â€œåŠŸè‡£â€â€”â€”RLHF æŠ€æœ¯è¯¦è§£
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rwkv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RWKV -- transformer ä¸ RNN çš„å¼ºå¼ºè”åˆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ryght-case-study/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ryght åœ¨ Hugging Face ä¸“å®¶åŠ©åŠ›ä¸‹èµ‹èƒ½åŒ»ç–—ä¿å¥å’Œç”Ÿå‘½ç§‘å­¦ä¹‹æ—…
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../safecoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¨ä»‹ SafeCoder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sc2-instruct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StarCoder2-Instruct: å®Œå…¨é€æ˜å’Œå¯è‡ªæˆ‘å¯¹é½çš„ä»£ç ç”Ÿæˆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sd3-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¬¢è¿ Stable Diffusion 3.5 Large åŠ å…¥ ğŸ§¨Â Diffusers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sd3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¬¢è¿ Stable Diffusion 3 åŠ å…¥ ğŸ§¨ Diffusers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sd_distillation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¼€æº SD-Small å’Œ SD-Tiny çŸ¥è¯†è’¸é¦ä»£ç ä¸æƒé‡
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sdxl_lora_advanced_script/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å…¨ä¸–ç•Œ LoRA è®­ç»ƒè„šæœ¬ï¼Œè”åˆèµ·æ¥!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setfit-absa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SetFitABSAï¼šåŸºäº SetFit çš„å°‘æ ·æœ¬ã€æ–¹é¢çº§æƒ…æ„Ÿåˆ†æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setfit-optimum-intel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨è‹±ç‰¹å°”è‡³å¼º CPU ä¸Šä½¿ç”¨ ğŸ¤— Optimum Intel å®ç°è¶…å¿« SetFit æ¨ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setfit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SetFit: é«˜æ•ˆçš„æ— æç¤ºå°‘æ ·æœ¬å­¦ä¹ 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smollm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SmolLMï¼šä¸€ä¸ªè¶…å¿«é€Ÿã€è¶…é«˜æ€§èƒ½çš„å°æ¨¡å‹é›†åˆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../speecht5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ SpeechT5 è¿›è¡Œè¯­éŸ³åˆæˆã€è¯†åˆ«å’Œæ›´å¤šåŠŸèƒ½
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql-console/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸ºæ•°æ®é›†è€Œç”Ÿçš„ SQL æ§åˆ¶å°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stable-diffusion-finetuning-intel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨è‹±ç‰¹å°” CPU ä¸Šå¾®è°ƒ Stable Diffusion æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stable-diffusion-inference-intel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨è‹±ç‰¹å°” CPU ä¸ŠåŠ é€Ÿ Stable Diffusion æ¨ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stable_diffusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨Diffusersæ¥å®ç°Stable Diffusion ğŸ§¨
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stackllama/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    â€œStackLLaMAâ€: ç”¨ RLHF è®­ç»ƒ LLaMA çš„æ‰‹æŠŠæ‰‹æ•™ç¨‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../starchat-alpha/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ StarCoder åˆ›å»ºä¸€ä¸ªç¼–ç¨‹åŠ©æ‰‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../starcoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StarCoderï¼šæœ€å…ˆè¿›çš„ä»£ç å¤§æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../starcoder2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StarCoder2 åŠ The Stack v2 æ•°æ®é›†æ­£å¼å‘å¸ƒ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../synthetic-data-save-costs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åˆæˆæ•°æ®ï¼šåˆ©ç”¨å¼€æºæŠ€æœ¯èŠ‚çº¦èµ„é‡‘ã€æ—¶é—´å’Œå‡å°‘ç¢³æ’æ”¾
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../synthid-text/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SynthID Textï¼šåœ¨ AI ç”Ÿæˆæ–‡æœ¬ä¸­åº”ç”¨ä¸å¯è§æ°´å°çš„æ–°æŠ€æœ¯
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../t2i-sdxl-adapters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨ SDXL ä¸Šç”¨ T2I-Adapter å®ç°é«˜æ•ˆå¯æ§çš„æ–‡ç”Ÿå›¾
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../text-to-video/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ·±å…¥ç†è§£æ–‡ç”Ÿè§†é¢‘æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../textgen-pipe-gaudi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åŸºäºè‹±ç‰¹å°”Â® GaudiÂ® 2 AI åŠ é€Ÿå™¨çš„æ–‡æœ¬ç”Ÿæˆæµæ°´çº¿
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tgi-benchmarking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TGI åŸºå‡†æµ‹è¯•
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../the-age-of-ml-as-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æœºå™¨å­¦ä¹ å³ä»£ç çš„æ—¶ä»£å·²ç»åˆ°æ¥
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../the_n_implementation_details_of_rlhf_with_ppo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ PPO ç®—æ³•è¿›è¡Œ RLHF çš„ N æ­¥å®ç°ç»†èŠ‚
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time-series-transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ ğŸ¤— Transformers è¿›è¡Œæ¦‚ç‡æ—¶é—´åºåˆ—é¢„æµ‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../train-dgx-cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨ NVIDIA DGX Cloudä¸Šä½¿ç”¨ H100 GPU è½»æ¾è®­ç»ƒæ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../train-optimize-sd-intel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åŸºäº NNCF å’Œ ğŸ¤— Optimum é¢å‘ Intel CPU å¯¹ Stable Diffusion ä¼˜åŒ–
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../train-sentence-transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç”¨ Sentence Transformers v3 è®­ç»ƒå’Œå¾®è°ƒåµŒå…¥æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../train-your-controlnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ diffusers è®­ç»ƒä½ è‡ªå·±çš„ ControlNet ğŸ§¨
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformers-design-philosophy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ã€œä¸è¦ã€œé‡å¤è‡ªå·±
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trl-ddpo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ DDPO åœ¨ TRL ä¸­å¾®è°ƒ Stable Diffusion æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trl-peft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åœ¨ä¸€å¼  24 GB çš„æ¶ˆè´¹çº§æ˜¾å¡ä¸Šç”¨ RLHF å¾®è°ƒ 20B LLMs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trufflesecurity-partnership/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face ä¸ TruffleHog æˆä¸ºåˆä½œä¼™ä¼´ï¼Œå®ç°é£é™©ä¿¡æ¯é¢„è­¦
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unified-tool-use/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¯¹ LLM å·¥å…·ä½¿ç”¨è¿›è¡Œç»Ÿä¸€
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unity-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¦‚ä½•å®‰è£…å’Œä½¿ç”¨ Hugging Face Unity API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unity-asr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¦‚ä½•åœ¨ Unity æ¸¸æˆä¸­é›†æˆ AI è¯­éŸ³è¯†åˆ«ï¼Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unity-in-spaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¦‚ä½•åœ¨ ğŸ¤— Space ä¸Šæ‰˜ç®¡ Unity æ¸¸æˆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../universal_assisted_generation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é€šç”¨è¾…åŠ©ç”Ÿæˆï¼šä½¿ç”¨ä»»æ„è¾…åŠ©æ¨¡å‹åŠ é€Ÿè§£ç 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vertex-colored-to-textured-mesh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é¡¶ç‚¹ç€è‰²ç½‘æ ¼è½¬æ¢ä¸º UV æ˜ å°„çš„çº¹ç†åŒ–ç½‘æ ¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vision_language_pretraining/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ·±å…¥äº†è§£è§†è§‰è¯­è¨€æ¨¡å‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vit-align/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kakao Brain çš„å¼€æº ViTã€ALIGN å’Œ COYO æ–‡å­—
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vlms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è§†è§‰è¯­è¨€æ¨¡å‹è¯¦è§£
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../watermarking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    äººå·¥æ™ºèƒ½æ°´å°æŠ€æœ¯å…¥é—¨ï¼šå·¥å…·ä¸æŠ€å·§
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../whisper-speculative-decoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨æ¨æµ‹è§£ç ä½¿ Whisper å®ç° 2 å€çš„æ¨ç†åŠ é€Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../winning-aimo-progress-prize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NuminaMath æ˜¯å¦‚ä½•è£è†ºé¦–å±Š AIMO è¿›æ­¥å¥–çš„ï¼Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xethub-joins-hf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XetHub åŠ å…¥ Hugging Face!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zero-shot-vqa-docmatix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LAVEï¼šä½¿ç”¨ LLM å¯¹ Docmatix è¿›è¡Œé›¶æ ·æœ¬ VQA è¯„ä¼° - æˆ‘ä»¬è¿˜éœ€è¦å¾®è°ƒå—ï¼Ÿ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è¿ç»´
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../blog/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    åšå®¢
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resume/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç®€å†æ¨¡æ¿
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/C-L-STARK/C-L-STARK.github.io/edit/master/docs/ml/1_58_llm_extreme_quantization.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm-2.3 6.35c.22-.21.22-.56 0-.77L15.42 7.3a.53.53 0 0 0-.77 0l-1 1 2.05 2.05zM7 14.94V17h2.06l6.06-6.06-2.06-2.06z"/></svg>
    </a>
  
  


<h1 id="llms-158">å°† LLMs ç²¾è°ƒè‡³ 1.58 æ¯”ç‰¹ï¼šä½¿æç«¯é‡åŒ–å˜ç®€å•<a class="headerlink" href="#llms-158" title="Permanent link">&para;</a></h1>
<p>éšç€å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰è§„æ¨¡å’Œå¤æ‚æ€§çš„å¢é•¿ï¼Œå¯»æ‰¾å‡å°‘å®ƒä»¬çš„è®¡ç®—å’Œèƒ½è€—çš„æ–¹æ³•å·²æˆä¸ºä¸€ä¸ªå…³é”®æŒ‘æˆ˜ã€‚ä¸€ç§æµè¡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯é‡åŒ–ï¼Œå…¶ä¸­å‚æ•°çš„ç²¾åº¦ä»æ ‡å‡†çš„16ä½æµ®ç‚¹ï¼ˆFP16ï¼‰æˆ–32ä½æµ®ç‚¹ï¼ˆFP32ï¼‰é™ä½åˆ°8ä½æˆ–4ä½ç­‰ä½ä½æ ¼å¼ã€‚è™½ç„¶è¿™ç§æ–¹æ³•æ˜¾è‘—å‡å°‘äº†å†…å­˜ä½¿ç”¨é‡å¹¶åŠ å¿«äº†è®¡ç®—é€Ÿåº¦ï¼Œä½†å¾€å¾€ä»¥å‡†ç¡®æ€§ä¸ºä»£ä»·ã€‚è¿‡åº¦é™ä½ç²¾åº¦å¯èƒ½å¯¼è‡´æ¨¡å‹ä¸¢å¤±å…³é”®ä¿¡æ¯ï¼Œä»è€Œå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚</p>
<p><a href="https://arxiv.org/abs/2402.17764">BitNet</a>æ˜¯ä¸€ç§ç‰¹æ®Šçš„transformersæ¶æ„ï¼Œå®ƒç”¨ä»…ä¸‰ä¸ªå€¼ï¼š<code>(-1, 0, 1)</code>è¡¨ç¤ºæ¯ä¸ªå‚æ•°ï¼Œæä¾›äº†æ¯ä¸ªå‚æ•°ä»…ä¸º1.58 ( \( log_2(3) \) )æ¯”ç‰¹çš„æç«¯é‡åŒ–ã€‚ç„¶è€Œï¼Œè¿™éœ€è¦ä»å¤´å¼€å§‹è®­ç»ƒä¸€ä¸ªæ¨¡å‹ã€‚è™½ç„¶ç»“æœä»¤äººå°è±¡æ·±åˆ»ï¼Œä½†å¹¶éæ¯ä¸ªäººéƒ½æœ‰é¢„ç®—æ¥è¿›è¡Œå¤§è¯­è¨€æ¨¡å‹çš„é¢„è®­ç»ƒã€‚ä¸ºäº†å…‹æœè¿™ä¸€é™åˆ¶ï¼Œæˆ‘ä»¬æ¢ç´¢äº†ä¸€äº›æŠ€å·§ï¼Œå…è®¸å°†ç°æœ‰æ¨¡å‹ç²¾è°ƒè‡³ 1.58 æ¯”ç‰¹ï¼ç»§ç»­é˜…è¯»ä»¥äº†è§£æ›´å¤šï¼</p>
<h2 id="_1">ç›®å½•<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="#ç®€ä»‹">ç®€ä»‹</a></li>
<li><a href="#æ›´æ·±å…¥åœ°äº†è§£ä»€ä¹ˆæ˜¯BitNet">æ›´æ·±å…¥åœ°äº†è§£ä»€ä¹ˆæ˜¯BitNet</a></li>
<li><a href="#1.58æ¯”ç‰¹çš„é¢„è®­ç»ƒç»“æœ">1.58 æ¯”ç‰¹çš„é¢„è®­ç»ƒç»“æœ</a></li>
<li><a href="#1.58æ¯”ç‰¹çš„å¾®è°ƒ">1.58 æ¯”ç‰¹çš„å¾®è°ƒ</a></li>
<li><a href="#ä½¿ç”¨çš„ç®—å­å’Œæµ‹è¯•æ ‡å‡†">ä½¿ç”¨çš„å†…æ ¸å’Œæµ‹è¯•æ ‡å‡†</a></li>
<li><a href="#ç»“è®º">ç»“è®º</a></li>
<li><a href="#è‡´è°¢">è‡´è°¢</a></li>
<li><a href="#æ›´å¤šèµ„æº">æ›´å¤šèµ„æº</a></li>
</ul>
<h2 id="_2">ç®€ä»‹<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p><a href="https://arxiv.org/abs/2402.17764">BitNet</a>æ˜¯ç”±å¾®è½¯ç ”ç©¶é™¢æå‡ºçš„ä¸€ç§æ¨¡å‹æ¶æ„ï¼Œå…¶é‡‡ç”¨æç«¯é‡åŒ–çš„æ–¹å¼ï¼Œç”¨ä»…ä¸‰ä¸ªå€¼ -1ã€0 å’Œ 1 æ¥è¡¨ç¤ºæ¯ä¸ªå‚æ•°ã€‚è¿™å¯¼è‡´æ¨¡å‹æ¯ä¸ªå‚æ•°ä»…ä½¿ç”¨1.58æ¯”ç‰¹ï¼Œæ˜¾è‘—é™ä½äº†è®¡ç®—å’Œå†…å­˜éœ€æ±‚ã€‚</p>
<p>è¯¥æ¶æ„åœ¨æ‰§è¡ŒçŸ©é˜µä¹˜æ³•æ—¶ä½¿ç”¨INT8åŠ æ³•è®¡ç®—ï¼Œè¿™ä¸ä»¥Llamaä¸ºä¾‹çš„ä¼ ç»ŸLLMæ¶æ„çš„FP16ä¹˜åŠ æ“ä½œå®Œå…¨ä¸åŒã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/matmulfree.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/matmulfree.png" alt="BitNet b1.58çš„æ–°è®¡ç®—èŒƒå¼" style="width: 100%;"/></a>
  <figcaption>BitNet b1.58çš„æ–°è®¡ç®—èŒƒå¼ (å‡ºå¤„: BitNetè®ºæ–‡ https://arxiv.org/abs/2402.17764)</figcaption>
</figure>

<p>è¿™ç§æ–¹æ³•åœ¨ç†è®ºä¸Šé™ä½èƒ½è€—ï¼Œä¸ Llama åŸºå‡†ç›¸æ¯”ï¼ŒBitNet b1.58 åœ¨çŸ©é˜µä¹˜æ³•æ–¹é¢èŠ‚çœäº† 71.4 å€çš„è®¡ç®—èƒ½è€—ã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/energy_consumption.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/energy_consumption.png" alt="BitNet b1.58ä¸Llamaçš„èƒ½è€—å¯¹æ¯”" style="width: 100%;"/></a>
  <figcaption>BitNet b1.58ä¸Llamaçš„èƒ½è€—å¯¹æ¯” (å‡ºå¤„: BitNet è®ºæ–‡ https://arxiv.org/abs/2402.17764)</figcaption>
</figure>

<p>æˆ‘ä»¬æˆåŠŸåœ°ä½¿ç”¨BitNetæ¶æ„å¯¹<a href="https://huggingface.co/meta-llama/Meta-Llama-3-8B-Instruct">Llama3 8B model</a>æ¨¡å‹è¿›è¡Œäº†ç²¾è°ƒï¼Œåœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸­å–å¾—äº†è‰¯å¥½çš„æ€§èƒ½ã€‚æˆ‘ä»¬å¼€å‘çš„ 8B æ¨¡å‹ç”± <a href="https://huggingface.co/HF1BitLLM">HF1BitLLM</a>ç»„ç»‡å‘å¸ƒã€‚å…¶ä¸­ä¸¤ä¸ªæ¨¡å‹åœ¨10Bçš„tokenä¸Šè¿›è¡Œäº†ä¸åŒçš„è®­ç»ƒè®¾ç½®çš„å¾®è°ƒï¼Œè€Œç¬¬ä¸‰ä¸ªæ¨¡å‹åœ¨100Bçš„tokenä¸Šè¿›è¡Œäº†å¾®è°ƒã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬çš„æ¨¡å‹åœ¨MMLUåŸºå‡†æµ‹è¯•ä¸­è¶…è¶Šäº† Llama 1 7B æ¨¡å‹ã€‚</p>
<h3 id="transformers">å¦‚ä½•åœ¨ Transformers ä¸­ä½¿ç”¨<a class="headerlink" href="#transformers" title="Permanent link">&para;</a></h3>
<p>ä¸ºäº†å°†BitNetæ¶æ„é›†æˆåˆ°Transformersä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ç§åä¸º"bitnet"çš„æ–°é‡åŒ–æ–¹æ³•ï¼ˆ<a href="https://github.com/huggingface/transformers/pull/33410">PR</a>ï¼‰ã€‚è¯¥æ–¹æ³•æ¶‰åŠå°†æ ‡å‡†çš„ Linear å±‚æ›¿æ¢ä¸ºä¸“é—¨è®¾è®¡ç”¨äº BitNet æ¶æ„çš„ BitLinear å±‚ï¼Œå…¶å®ç°äº†ç›¸åº”çš„åŠ¨æ€çš„æ¿€æ´»é‡åŒ–ã€æƒé‡è§£åŒ…å’ŒçŸ©é˜µä¹˜æ³•çš„æ“ä½œã€‚</p>
<p>åœ¨ Transformers ä¸­åŠ è½½å’Œæµ‹è¯•æ¨¡å‹éå¸¸ç®€å•ï¼ŒAPIæ²¡æœ‰ä»»ä½•æ›´æ”¹ï¼š
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForCausalLM</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s2">&quot;HF1BitLLM/Llama3-8B-1.58-100B-tokens&quot;</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">device_map</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">torch_dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bfloat16</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span>    
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;meta-llama/Meta-Llama-3-8B-Instruct&quot;</span><span class="p">)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">input_text</span> <span class="o">=</span> <span class="s2">&quot;Daniel went back to the the the garden. Mary travelled to the kitchen. Sandra journeyed to the kitchen. Sandra went to the hallway. John went to the bedroom. Mary went back to the garden. Where is Mary?</span><span class="se">\n</span><span class="s2">Answer:&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">input_ids</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;pt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">max_new_tokens</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">generated_text</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">generated_text</span><span class="p">)</span>
</span></code></pre></div>
é€šè¿‡è¿™æ®µä»£ç ï¼Œä¸€åˆ‡éƒ½ç›´æ¥åœ¨å¹•åå®Œç¾åœ°å®Œæˆäº†ï¼Œå› æ­¤æ— éœ€æ‹…å¿ƒé¢å¤–çš„å¤æ‚æ€§ï¼Œæ‚¨åªéœ€è¦åšçš„åªæ˜¯å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„transformersã€‚</p>
<p>è¦å¿«é€Ÿæµ‹è¯•æ¨¡å‹ï¼Œè¯·æŸ¥çœ‹è¿™ä¸ª <a href="https://colab.research.google.com/drive/1ovmQUOtnYIdvcBkwEE4MzVL1HKfFHdNT?usp=sharing">notebook</a>ã€‚</p>
<h2 id="bitnet">æ›´æ·±å…¥åœ°äº†è§£ä»€ä¹ˆæ˜¯BitNet<a class="headerlink" href="#bitnet" title="Permanent link">&para;</a></h2>
<p><a href="https://arxiv.org/abs/2402.17764">BitNet</a> åœ¨å¤šå¤´æ³¨æ„åŠ›å’Œå‰é¦ˆç½‘ç»œä¸­æ›¿æ¢äº†ä¼ ç»Ÿçš„ Linear å±‚ï¼Œä½¿ç”¨äº†ç§°ä¸º BitLinear çš„ç‰¹æ®Šå±‚ï¼Œè¿™äº›å±‚ä½¿ç”¨ä¸‰å€¼ç²¾åº¦ï¼ˆç”šè‡³åœ¨åˆå§‹ç‰ˆæœ¬ä¸­ä½¿ç”¨äºŒå€¼ç²¾åº¦ï¼‰ã€‚åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ BitLinear å±‚å¯¹æƒé‡ä½¿ç”¨ä¸‰å€¼ç²¾åº¦ï¼ˆå–å€¼ä¸º -1ã€0 å’Œ 1ï¼‰ï¼Œå¹¶å°†æ¿€æ´»é‡åŒ–ä¸º 8 ä½ç²¾åº¦ã€‚æˆ‘ä»¬åœ¨è®­ç»ƒå’Œæ¨ç†ä¸­ä½¿ç”¨ä¸åŒçš„ BitLinear å®ç°ï¼Œæ¥ä¸‹æ¥çš„éƒ¨åˆ†å°†ä¼šä»‹ç»ã€‚</p>
<p>åœ¨ä¸‰å€¼ç²¾åº¦è®­ç»ƒä¸­çš„ä¸»è¦éšœç¢æ˜¯æƒé‡å€¼è¢«ç¦»æ•£åŒ–ï¼ˆé€šè¿‡<code>round()</code>å‡½æ•°ï¼‰ï¼Œå› æ­¤ä¸å¯å¾®åˆ†ã€‚BitLinear é€šè¿‡ä¸€ä¸ªå·§å¦™çš„æŠ€å·§è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š<a href="https://arxiv.org/abs/1903.05662">STE (Straight Through Estimator)</a>ã€‚STE å…è®¸æ¢¯åº¦é€šè¿‡ä¸å¯å¾®åˆ†çš„å–æ•´æ“ä½œï¼Œé€šè¿‡å°†å…¶æ¢¯åº¦è¿‘ä¼¼ä¸º1ï¼ˆå°†<code>round()</code>è§†ä¸ºç­‰åŒäºæ’ç­‰å‡½æ•°ï¼‰æ¥å®ç°ã€‚å¦ä¸€ç§è§‚ç‚¹æ˜¯ï¼ŒSTE è®©æ¢¯åº¦é€šè¿‡å–æ•´æ­¥éª¤ï¼Œå¥½åƒå–æ•´ä»æœªå‘ç”Ÿè¿‡ä¸€æ ·ï¼Œä»è€Œä½¿ç”¨æ ‡å‡†åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–æŠ€æœ¯æ¥æ›´æ–°æƒé‡ã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/bitlinear.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/bitlinear.png" alt="ä½¿ç”¨BitLienarçš„BitNetæ¨¡å‹æ¶æ„" style="width: 100%"/></a>
  <figcaption>ä½¿ç”¨ BitLienar çš„ BitNet æ¨¡å‹æ¶æ„ (å‡ºå¤„: BitNet è®ºæ–‡ https://arxiv.org/pdf/2310.11453)</figcaption>
</figure>

<h3 id="_3">è®­ç»ƒ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>æˆ‘ä»¬åœ¨å®Œæ•´ç²¾åº¦ä¸‹è¿›è¡Œè®­ç»ƒï¼Œä½†åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å°†æƒé‡é‡åŒ–ä¸ºä¸‰å€¼ï¼Œä½¿ç”¨ per-tensor çš„å¯¹ç§°é‡åŒ–ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è®¡ç®—æƒé‡çŸ©é˜µçš„ç»å¯¹å€¼çš„å¹³å‡å€¼ï¼Œå¹¶å°†å…¶ç”¨ä½œ scaleã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æƒé‡é™¤ä»¥ scaleï¼Œå¯¹å€¼è¿›è¡Œå–æ•´ï¼Œå°†å…¶é™åˆ¶åœ¨ -1 å’Œ 1 çš„åŒºé—´å†…ï¼Œæœ€åå°†æƒé‡å…¶åé‡åŒ–å›å®Œæ•´ç²¾åº¦ã€‚</p>
<p>\( scale_w = \frac{1}{\frac{1}{nm} \sum_{ij} |W_{ij}|} \)</p>
<p>\( W_q = \text{clamp}_{[-1,1]}(\text{round}(W*scale)) \)</p>
<p>\( W_{dequantized} = W_q*scale_w \)</p>
<p>æ¿€æ´»ç„¶åè¢«é‡åŒ–ä¸ºæŒ‡å®šçš„æ¯”ç‰¹å®½åº¦ï¼ˆåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹æ˜¯8ä½ï¼‰ï¼Œä½¿ç”¨per-tokençš„æœ€å¤§ç»å¯¹å€¼é‡åŒ–ï¼ˆè¦äº†è§£é‡åŒ–æ–¹æ³•çš„å…¨é¢ä»‹ç»ï¼Œè¯·æŸ¥çœ‹è¿™ç¯‡<a href="https://mlabonne.github.io/blog/posts/Introduction_to_Weight_Quantization.html">post</a>ï¼‰ã€‚è¿™æ¶‰åŠå°†æ¿€æ´»ç¼©æ”¾åˆ°[-128, 127]çš„èŒƒå›´ä»¥é€‚åº”8ä½æ¯”ç‰¹å®½åº¦ã€‚é‡åŒ–å…¬å¼å¦‚ä¸‹ï¼š</p>
<p>\( scale_x = \frac{127}{|X|_{\text{max}, \, \text{dim}=-1}} \)</p>
<p>\( X_q = \text{clamp}_{[-128,127]}(\text{round}(X*scale)) \)</p>
<p>\( X_{dequantized} = X_q * scale_x \)</p>
<p>ä¸ºäº†ä½¿è¿™äº›å…¬å¼æ›´åŠ æ¸…æ™°ï¼Œä¸‹é¢æ˜¯ä¸€äº›ä½¿ç”¨3x3çš„çŸ©é˜µçš„æƒé‡å’Œæ¿€æ´»é‡åŒ–çš„ä¾‹å­ï¼š</p>
<hr />
<details>
  <summary>ä¾‹å­1ï¼šæƒé‡çŸ©é˜µé‡åŒ–</summary>

  å‡è®¾æƒé‡çŸ©é˜µ \( W \) ä¸º:


  \\(  W = 
  \begin{bmatrix}
  0.8 & -0.5 & 1.2 \\
  -1.5 & 0.4 & -0.9 \\
  1.3 & -0.7 & 0.2
  \end{bmatrix} \\)

  **ç¬¬ä¸€æ­¥ï¼šè®¡ç®—æƒé‡çš„scale**

  ä½¿ç”¨å…¬å¼ï¼š


  \\( scale_w = \frac{1}{\frac{1}{nm} \sum_{ij} |W_{ij}|} \\)

  æˆ‘ä»¬è®¡ç®— \( W \)æ¿€æ´»å€¼çš„å¹³å‡å€¼ï¼š


\\( \frac{1}{nm} \sum_{ij} |W_{ij}| = \frac{1}{9}(0.8 + 0.5 + 1.2 + 1.5 + 0.4 + 0.9 + 1.3 + 0.7 + 0.2) = \frac{1}{9}(7.5) = 0.8333 \\)

  ç°åœ¨å¾—åˆ°çš„ scale ä¸ºï¼š


  \\( scale_w = \frac{1}{0.8333} \approx 1.2 \\)

  **ç¬¬äºŒæ­¥ï¼šé‡åŒ–æƒé‡çŸ©é˜µ**

  ä½¿ç”¨å…¬å¼ï¼š

 \\( W_q = \text{clamp}_{[-1, 1]}(\text{round}(W \times scale_w)) \\)

 æˆ‘ä»¬é¦–å…ˆå°†æƒé‡ç¼©æ”¾\\( scale_w \approx 1.2 \\)å€:

\\( W \times scale_w = 
  \begin{bmatrix}
  0.8 \times 1.2 & -0.5 \times 1.2 & 1.2 \times 1.2 \\
  -1.5 \times 1.2 & 0.4 \times 1.2 & -0.9 \times 1.2 \\
  1.3 \times 1.2 & -0.7 \times 1.2 & 0.2 \times 1.2
  \end{bmatrix}
  =
  \begin{bmatrix}
  0.96 & -0.6 & 1.44 \\
  -1.8 & 0.48 & -1.08 \\
  1.56 & -0.84 & 0.24
  \end{bmatrix} \\)

  ç„¶åæˆ‘ä»¬å°†å…¶å–æ•´å¹¶æˆªæ–­åˆ° \\( [-1, 1] \\)çš„åŒºé—´å†…ï¼š

\\( W_q = 
  \begin{bmatrix}
  1 & -1 & 1 \\
  -1 & 0 & -1 \\
  1 & -1 & 0
  \end{bmatrix} \\)

**ç¬¬ä¸‰æ­¥ï¼šåé‡åŒ–æƒé‡**

  æœ€åæˆ‘ä»¬åé‡åŒ–è¯¥æƒé‡ï¼š


\\( W_{dequantized} = W_q \times scale_w \\)

  ä½¿ç”¨scale_wå°†æƒé‡æ¢å¤åˆ°åŸæ¥çš„èŒƒå›´ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š


 \\( W_{dequantized} = 
  \begin{bmatrix}
  1 \times 1.2 & -1 \times 1.2 & 1 \times 1.2 \\
  -1 \times 1.2 & 0 \times 1.2 & -1 \times 1.2 \\
  1 \times 1.2 & -1 \times 1.2 & 0 \times 1.2
  \end{bmatrix}
  =
  \begin{bmatrix}
  1.2 & -1.2 & 1.2 \\
  -1.2 & 0 & -1.2 \\
  1.2 & -1.2 & 0
  \end{bmatrix} \\)

</details>

<details>
  <summary>ä¾‹å­2ï¼šæ¿€æ´»çŸ©é˜µçš„é‡åŒ–</summary>

  å‡è®¾æ¿€æ´»çŸ©é˜µ\( X \)ä¸ºï¼š

  \\( X = 
  \begin{bmatrix}
  1.0 & -0.6 & 0.7 \\
  -0.9 & 0.4 & -1.2 \\
  0.8 & -0.5 & 0.3
  \end{bmatrix} \\) 

  **ç¬¬ä¸€æ­¥ï¼šè®¡ç®—æ¿€æ´»çš„ scale**

  å¯¹äºæ¯ä¸€è¡Œï¼ˆæˆ–è€…é€šé“ï¼‰ï¼Œè®¡ç®—å…¶æœ€å¤§çš„ç»å¯¹å€¼

 - **ç¬¬1è¡Œ**ï¼šæœ€å¤§ç»å¯¹å€¼ = 1.0
 - **ç¬¬2è¡Œ**ï¼šæœ€å¤§ç»å¯¹å€¼ = 1.2
 - **ç¬¬3è¡Œ**ï¼šæœ€å¤§ç»å¯¹å€¼ = 0.8

  è®¡ç®—æ¯è¡Œçš„ scaleï¼š

  \\( \text{scale} = \begin{bmatrix}
  \frac{127}{1.0} \\
  \frac{127}{1.2} \\
  \frac{127}{0.8}
  \end{bmatrix}
  =
  \begin{bmatrix}
  127 \\
  105.83 \\
  158.75
  \end{bmatrix} \\)

  **æ­¥éª¤2ï¼šé‡åŒ–æ¿€æ´»çŸ©é˜µ**  

  ä½¿ç”¨ä»¥ä¸‹å…¬å¼ï¼š

  \\( X_q = \text{clamp}_{[-128,127]}(\text{round}(X \times \text{scale})) \\)

  ç¼©æ”¾ç›¸åº”çš„æ¿€æ´»å€¼ï¼š

  \\( X \times \text{scale} = 
  \begin{bmatrix}
  1.0 \times 127 & -0.6 \times 127 & 0.7 \times 127 \\
  -0.9 \times 105.83 & 0.4 \times 105.83 & -1.2 \times 105.83 \\
  0.8 \times 158.75 & -0.5 \times 158.75 & 0.3 \times 158.75
  \end{bmatrix}
  =
  \begin{bmatrix}
  127 & -76.2 & 88.9 \\
  -95.2 & 42.3 & -127 \\
  127 & -79.4 & 47.6
  \end{bmatrix} \\)

  å°†å€¼å–æ•´å¹¶æˆªæ–­åœ¨\\([-128, 127] \\)çš„èŒƒå›´å†…ï¼š

  \\( X_q = 
  \begin{bmatrix}
  127 & -76 & 89 \\
  -95 & 42 & -127 \\
  127 & -79 & 48
  \end{bmatrix} \\)

  **ç¬¬ä¸‰æ­¥ï¼šåé‡åŒ–æ¿€æ´»**

  æœ€åæˆ‘ä»¬åé‡åŒ–æ¿€æ´»å€¼ï¼š

  \\( X_{dequantized} = X_q \times \frac{1}{\text{scale}} \\)


  ä½¿ç”¨ scale å¯¹å€¼è¿›è¡Œæ¢å¤ï¼š

  \\( X_{dequantized} = 
  \begin{bmatrix}
  127 \times \frac{1}{127} & -76 \times \frac{1}{127} & 89 \times \frac{1}{127} \\
  -95 \times \frac{1}{105.83} & 42 \times \frac{1}{105.83} & -127 \times \frac{1}{105.83} \\
  127 \times \frac{1}{158.75} & -79 \times \frac{1}{158.75} & 48 \times \frac{1}{158.75}
  \end{bmatrix}
  =
  \begin{bmatrix}
  1.0 & -0.6 & 0.7 \\
  -0.9 & 0.4 & -1.2 \\
  0.8 & -0.5 & 0.3
  \end{bmatrix} \\)


</details>

<hr />
<p>æˆ‘ä»¬åœ¨é‡åŒ–æ¿€æ´»ä¹‹å‰ä½¿ç”¨å±‚å½’ä¸€åŒ–ï¼ˆLayer Normalizationï¼ŒLNï¼‰ä»¥ä¿æŒè¾“å‡ºçš„æ–¹å·®ï¼š</p>
<p>\( \text{LN}(x) = \frac{x - E(x)}{\sqrt{\text{Var}(x) + \epsilon}} \)</p>
<p>è¿™é‡ŒÎµæ˜¯é˜²æ­¢æº¢å‡ºçš„ä¸€ä¸ªéå¸¸å°çš„å€¼</p>
<p>å¦‚å‰æ‰€è¿°ï¼Œ<code>round()</code>å‡½æ•°æ˜¯ä¸å¯å¾®åˆ†çš„ã€‚æˆ‘ä»¬ä½¿ç”¨<code>detach()</code>ä½œä¸ºä¸€ä¸ªæŠ€å·§ï¼Œåœ¨åå‘ä¼ æ’­ä¸­å®ç°å¯å¾®åˆ†çš„STEï¼ˆStraight-Through Estimatorï¼‰ï¼š</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Adapted from https://github.com/microsoft/unilm/blob/master/bitnet/The-Era-of-1-bit-LLMs__Training_Tips_Code_FAQ.pdf</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">import</span> <span class="nn">torch</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span> 
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="k">def</span> <span class="nf">activation_quant</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="n">scale</span> <span class="o">=</span> <span class="mf">127.0</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="o">-</span><span class="mi">128</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="k">return</span> <span class="n">y</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="k">def</span> <span class="nf">weight_quant</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">w</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="n">u</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="k">return</span> <span class="n">u</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="k">class</span> <span class="nc">BitLinear</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">):</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="sd">    Only for training</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>        <span class="n">x_norm</span> <span class="o">=</span> <span class="n">LN</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>        <span class="c1"># A trick for implementing Straightâˆ’Throughâˆ’Estimator (STE) using detach()</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>        <span class="n">x_quant</span> <span class="o">=</span> <span class="n">x_norm</span> <span class="o">+</span> <span class="p">(</span><span class="n">activation_quant</span><span class="p">(</span><span class="n">x_norm</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_norm</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>        <span class="n">w_quant</span> <span class="o">=</span> <span class="n">w</span> <span class="o">+</span> <span class="p">(</span><span class="n">weight_quant</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>        <span class="c1"># Perform quantized linear transformation</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x_quant</span><span class="p">,</span> <span class="n">w_quant</span><span class="p">)</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>        <span class="k">return</span> <span class="n">y</span>
</span></code></pre></div>
<h3 id="_4">æ¨ç†<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>åœ¨æ¨ç†è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯å°†æƒé‡é‡åŒ–ä¸ºä¸‰å€¼ï¼Œè€Œä¸é‡æ–°åé‡åŒ–ã€‚æˆ‘ä»¬å¯¹æ¿€æ´»é‡‡ç”¨ç›¸åŒçš„æ–¹æ³•ï¼Œä½¿ç”¨8ä½ç²¾åº¦ï¼Œç„¶åä½¿ç”¨é«˜æ•ˆçš„ç®—å­æ‰§è¡ŒçŸ©é˜µä¹˜æ³•ï¼Œæ¥ç€é€šè¿‡æƒé‡å’Œæ¿€æ´»çš„ scale è¿›è¡Œé™¤æ³•ã€‚è¿™èƒ½å¤Ÿæ˜¾è‘—æé«˜æ¨ç†çš„é€Ÿåº¦ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¼˜åŒ–çš„ç¡¬ä»¶ä¸Šã€‚æ‚¨å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è®­ç»ƒæœŸé—´åé‡åŒ–çš„è¿‡ç¨‹ä¸æ¨ç†ä¸åŒï¼Œå› ä¸ºçŸ©é˜µä¹˜æ³•ä¿æŒåœ¨fp16/bf16/fp32ä¸­ä»¥è¿›è¡Œæ­£ç¡®çš„è®­ç»ƒã€‚</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Adapted from https://github.com/microsoft/unilm/blob/master/bitnet/The-Era-of-1-bit-LLMs__Training_Tips_Code_FAQ.pdf</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kn">import</span> <span class="nn">torch</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span> 
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="k">def</span> <span class="nf">activation_quant_inference</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">LN</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    <span class="n">scale</span> <span class="o">=</span> <span class="mf">127.0</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="o">-</span><span class="mi">128</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">scale</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="k">class</span> <span class="nc">BitLinear</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">):</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="sd">    Only for training</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="c1"># weights here are already quantized to (-1, 0, 1)    </span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>        <span class="n">w_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_scale</span>  
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>        <span class="n">x_quant</span><span class="p">,</span> <span class="n">x_scale</span> <span class="o">=</span> <span class="n">activation_quant_inference</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">efficient_kernel</span><span class="p">(</span><span class="n">x_quant</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="n">w_scale</span> <span class="o">/</span> <span class="n">x_scale</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>        <span class="k">return</span> <span class="n">y</span>
</span></code></pre></div>
<h2 id="158">1.58æ¯”ç‰¹çš„é¢„è®­ç»ƒç»“æœ<a class="headerlink" href="#158" title="Permanent link">&para;</a></h2>
<p>åœ¨å°è¯•å¾®è°ƒä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆå°è¯•å¤ç° BitNet è®ºæ–‡ä¸­å…³äºé¢„è®­ç»ƒçš„ç»“æœã€‚æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå°æ•°æ®é›†<a href="https://huggingface.co/datasets/roneneldan/TinyStories">tinystories</a>ï¼Œä»¥åŠä¸€ä¸ª<a href="https://huggingface.co/meta-llama/Meta-Llama-3-8B-Instruct">Llama3 8Bæ¨¡å‹</a>ã€‚æˆ‘ä»¬å‘ç°ï¼Œåƒè®ºæ–‡ä¸­æ‰€åšçš„é‚£æ ·æ·»åŠ å½’ä¸€åŒ–å‡½æ•°ä¼šæé«˜æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œåœ¨è®­ç»ƒ2000æ­¥ä¹‹åï¼Œæˆ‘ä»¬åœ¨éªŒè¯é›†ä¸Šçš„å›°æƒ‘åº¦ï¼Œæ²¡æœ‰å½’ä¸€åŒ–æ—¶ä¸º 6.3ï¼Œä½¿ç”¨å½’ä¸€åŒ–åä¸º 5.9ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œè®­ç»ƒéƒ½æ˜¯ç¨³å®šçš„ã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/pre-training.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/pre-training.png" alt="åœ¨æœ‰å±‚å½’ä¸€åŒ–ï¼ˆè“è‰²ï¼‰å’Œæ²¡æœ‰ï¼ˆæ©™è‰²ï¼‰çš„é¢„è®­ç»ƒå›¾åƒ" style="width: 100%;"/></a>
  <figcaption> åœ¨æœ‰å±‚å½’ä¸€åŒ–ï¼ˆè“è‰²ï¼‰å’Œæ²¡æœ‰ï¼ˆæ©™è‰²ï¼‰çš„é¢„è®­ç»ƒå›¾åƒ </figcaption>
</figure>

<p>è™½ç„¶è¿™ç§æ–¹æ³•åœ¨é¢„è®­ç»ƒä¸­çœ‹èµ·æ¥éå¸¸æœ‰è¶£ï¼Œä½†åªæœ‰å°‘æ•°æœºæ„èƒ½å¤Ÿè´Ÿæ‹…å¤§è§„æ¨¡çš„é¢„è®­ç»ƒã€‚ç„¶è€Œï¼Œå› ä¸ºå­˜åœ¨æœ‰å¤§é‡å¼ºå¤§çš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œå¦‚æœå®ƒä»¬å¯ä»¥åœ¨é¢„è®­ç»ƒåè½¬æ¢ä¸º 1.58 ä½ï¼Œå°†ä¼šéå¸¸æœ‰ç”¨ã€‚å…¶ä»–å°ç»„æ›¾æŠ¥å‘Šç§°ï¼Œå¾®è°ƒçš„ç»“æœä¸å¦‚é¢„è®­ç»ƒå–å¾—çš„ç»“æœé‚£ä¹ˆå¼ºå¤§ï¼Œå› æ­¤æˆ‘ä»¬å±•å¼€äº†ç ”ç©¶ï¼Œçœ‹çœ‹æˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿè®© 1.58 æ¯”ç‰¹åœ°å¾®è°ƒèµ·ä½œç”¨ã€‚</p>
<h2 id="158_1">1.58æ¯”ç‰¹çš„å¾®è°ƒ<a class="headerlink" href="#158_1" title="Permanent link">&para;</a></h2>
<p>å½“æˆ‘ä»¬ä»é¢„è®­ç»ƒçš„ Llama3 8B æƒé‡å¼€å§‹å¾®è°ƒæ—¶ï¼Œæ¨¡å‹è¡¨ç°ç•¥æœ‰æé«˜ï¼Œä½†å¹¶ä¸å¦‚æˆ‘ä»¬é¢„æœŸçš„é‚£ä¹ˆå¥½ã€‚</p>
<blockquote>
<p><strong>Note:</strong> æ‰€æœ‰çš„å®éªŒéƒ½åœ¨<a href="https://github.com/huggingface/nanotron">Nanotron</a>ä¸Šè¿›è¡Œï¼Œå¦‚æœæ‚¨å¯¹å°è¯•1.58ä½çš„é¢„è®­ç»ƒæˆ–å¾®è°ƒæ„Ÿå…´è¶£ï¼Œå¯ä»¥æŸ¥çœ‹è¿™ä¸ª<a href="https://github.com/huggingface/nanotron/pull/180">PRé“¾æ¥</a>ã€‚</p>
</blockquote>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/finetuning_basic.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/finetuning_basic.png" alt="å¾®è°ƒæ›²çº¿å¯¹æ¯”é¢„è®­ç»ƒæ›²çº¿" style="width: 100%;"/></a>
  <figcaption> å¾®è°ƒæ›²çº¿å¯¹æ¯”é¢„è®­ç»ƒæ›²çº¿ </figcaption>
</figure>

<p>ä¸ºäº†ç†è§£åŸå› ï¼Œæˆ‘ä»¬å°è¯•æ£€æŸ¥éšæœºåˆå§‹åŒ–æ¨¡å‹å’Œé¢„è®­ç»ƒæ¨¡å‹çš„æƒé‡åˆ†å¸ƒï¼Œä»¥ç¡®å®šå¯èƒ½çš„é—®é¢˜ã€‚</p>
<div style="display: flex; justify-content: center;">
  <figure style="margin-right: 20px; text-align: center;">
    <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/poids_alÃ©atoires.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/poids_alÃ©atoires.png" alt="éšæœºçš„æƒé‡åˆ†å¸ƒï¼ˆåˆå¹¶çš„æ ‡å‡†å·®ä¸º2ï¼‰" style="width: 400px;" /></a>
    <figcaption> éšæœºçš„æƒé‡åˆ†å¸ƒï¼ˆåˆå¹¶çš„æ ‡å‡†å·®ä¸º 2ï¼‰</figcaption>
  </figure>
  <figure style="text-align: center;">
    <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/poids_llama3.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/poids_llama3.png" alt="é¢„è®­ç»ƒLlama3çš„æƒé‡åˆ†å¸ƒ" style="width: 400px;" /></a>
    <figcaption>é¢„è®­ç»ƒLlama3çš„æƒé‡åˆ†å¸ƒ</figcaption>
  </figure>
</div>

<p>ä¸¤ä¸ªåˆ†å¸ƒçš„scaleåˆ†åˆ«ä¸ºï¼š</p>
<div style="display: flex; justify-content: center;">
  <figure style="margin-right: 20px; text-align: center;">
    <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/scales_random.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/scales_random.png" alt="éšæœºæƒé‡çš„scaleåˆ†å¸ƒ" style="width: 400px;" /></a>
    <figcaption> éšæœºæƒé‡çš„scaleåˆ†å¸ƒ </figcaption>
  </figure>
  <figure style="text-align: center;">
    <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/scales_llama3.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/scales_llama3.png" alt="é¢„è®­ç»ƒæƒé‡çš„scaleåˆ†å¸ƒ" style="width: 400px;" /></a>
    <figcaption> é¢„è®­ç»ƒæƒé‡çš„scaleåˆ†å¸ƒ </figcaption>
  </figure>
</div>

<p>åˆå§‹éšæœºæƒé‡åˆ†å¸ƒæ˜¯ä¸¤ä¸ªæ­£æ€åˆ†å¸ƒçš„æ··åˆï¼š</p>
<ul>
<li>ä¸€ä¸ªæ ‡å‡†å·®ä¸º \( 0.025 \)</li>
<li>å¦ä¸€ä¸ªæ ‡å‡†å·®ä¸º \( \frac{0.025}{\sqrt{2 \cdot \text{num_hidden_layers}}} = 0.00325 \)</li>
</ul>
<p>è¿™æ˜¯å› ä¸ºåœ¨<code>nanotron</code>ä¸­å¯¹åˆ—çº¿æ€§æƒé‡å’Œè¡Œçº¿æ€§æƒé‡ä½¿ç”¨äº†ä¸åŒçš„æ ‡å‡†å·®ã€‚åœ¨é‡åŒ–ç‰ˆæœ¬ä¸­ï¼Œæ‰€æœ‰çŸ©é˜µåªæœ‰ä¸¤ä¸ªæƒé‡å°ºåº¦ï¼ˆ50.25å’Œ402ï¼‰ï¼Œè¿™ä¸¤ä¸ªå°ºåº¦åˆ†åˆ«æ˜¯æ¯ä¸ªçŸ©é˜µæƒé‡çš„ç»å¯¹å€¼çš„å€’æ•°çš„å¹³å‡å€¼ï¼š<code>scale = 1.0 / w.abs().mean().clamp_(min=1e-5)</code></p>
<ul>
<li>å¯¹äº \(\text{scale} = 50.25 \)ï¼Œ\( w.abs().mean() = 0.0199 \)ï¼Œå¯¼è‡´ \(\text{std} = 0.025 \)ï¼Œä¸æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ ‡å‡†å·®ç›¸åŒ¹é…ã€‚ç”¨äºæ¨å¯¼æ ‡å‡†å·®çš„å…¬å¼åŸºäº \( |w| \) çš„åŠæ­£æ€åˆ†å¸ƒçš„æœŸæœ›ï¼š<br />
  \( \mathbb{E}(|w|) = \text{std}(w) \cdot \sqrt{\frac{2}{\pi}} \)</li>
<li>å¯¹äº \(\text{scale} = 402 \)ï¼Œ\( w.abs().mean() = 0.0025 \)ï¼Œå¯¼è‡´ \(\text{std} = 0.00325 \)</li>
</ul>
<p>å¦ä¸€æ–¹é¢ï¼Œé¢„è®­ç»ƒæƒé‡çš„åˆ†å¸ƒçœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªæ ‡å‡†å·®ä¸º \(0.013\) çš„æ­£æ€åˆ†å¸ƒã€‚</p>
<p>æ˜¾ç„¶ï¼Œé¢„è®­ç»ƒæ¨¡å‹ä»æ›´å¤šä¿¡æ¯ï¼ˆscaleï¼‰å¼€å§‹ï¼Œè€Œéšæœºåˆå§‹åŒ–çš„æ¨¡å‹ä»å®é™…ä¸Šæ²¡æœ‰ä¿¡æ¯å¼€å§‹ï¼Œå¹¶éšç€æ—¶é—´é€æ¸å¢åŠ ä¿¡æ¯ã€‚æˆ‘ä»¬çš„ç»“è®ºæ˜¯ï¼Œä»éšæœºæƒé‡å¼€å§‹ç»™äºˆæ¨¡å‹æœ€å°çš„åˆå§‹ä¿¡æ¯ï¼Œä»è€Œå®ç°é€æ­¥å­¦ä¹ è¿‡ç¨‹ï¼Œè€Œåœ¨å¾®è°ƒæœŸé—´ï¼Œå¼•å…¥BitLinearå±‚ä¼šä½¿æ¨¡å‹ä¸§å¤±æ‰€æœ‰å…ˆå‰çš„ä¿¡æ¯ã€‚</p>
<p>ä¸ºäº†æ”¹å–„å¾®è°ƒç»“æœï¼Œæˆ‘ä»¬å°è¯•äº†ä¸åŒçš„æŠ€æœ¯ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°è¯•è¿‡ä½¿ç”¨ per-row å’Œ per-column é‡åŒ–è€Œä¸æ˜¯ per-tensor é‡åŒ–ï¼Œä»¥ä¿ç•™æ›´å¤šæ¥è‡ªLlama 3æƒé‡çš„ä¿¡æ¯ã€‚æˆ‘ä»¬è¿˜å°è¯•æ”¹å˜å°ºåº¦è®¡ç®—çš„æ–¹å¼ï¼šä¸å†ä»…ä»…å°†æƒé‡çš„å¹³å‡ç»å¯¹å€¼ä½œä¸ºå°ºåº¦ï¼Œè€Œæ˜¯å°†å¼‚å¸¸å€¼ï¼ˆè¶…è¿‡kå€å¹³å‡ç»å¯¹å€¼çš„å€¼ï¼Œå…¶ä¸­kæ˜¯æˆ‘ä»¬åœ¨å®éªŒä¸­å°è¯•å˜åŒ–çš„å¸¸æ•°ï¼‰çš„å¹³å‡ç»å¯¹å€¼ä½œä¸ºå°ºåº¦ï¼Œä½†æˆ‘ä»¬å¹¶æ²¡æœ‰æ³¨æ„åˆ°æ˜æ˜¾çš„æ”¹å–„ã€‚</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">def</span> <span class="nf">scale_outliers</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">threshold_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="n">mean_absolute_value</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tensor</span><span class="p">))</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold_factor</span> <span class="o">*</span> <span class="n">mean_absolute_value</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">outliers</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">mean_outlier_value</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">outliers</span><span class="p">))</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="k">return</span> <span class="n">mean_outlier_value</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="k">def</span> <span class="nf">weight_quant_scaling</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">scale_outliers</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="n">quantized_weights</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="k">return</span> <span class="n">quantized_weights</span>
</span></code></pre></div>
<p>æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œéšæœºæƒé‡å’Œ Llama 3 æƒé‡åœ¨æŸå¤±å¼€å§‹æ—¶çš„æ•°å€¼çº¦ä¸º13ï¼Œè¿™è¡¨æ˜å½“å¼•å…¥é‡åŒ–æ—¶ï¼ŒLlama 3æ¨¡å‹å¤±å»äº†æ‰€æœ‰å…ˆå‰çš„ä¿¡æ¯ã€‚ä¸ºäº†è¿›ä¸€æ­¥ç ”ç©¶æ¨¡å‹åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¤±å»äº†å¤šå°‘ä¿¡æ¯ï¼Œæˆ‘ä»¬å°è¯•äº† per-group é‡åŒ–ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªåˆç†æ€§æ£€æŸ¥ï¼Œæˆ‘ä»¬é¦–å…ˆå°† group å¤§å°è®¾ç½®ä¸º 1ï¼Œè¿™åŸºæœ¬ä¸Šæ„å‘³ç€æ²¡æœ‰é‡åŒ–ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŸå¤±ä» 1.45 å¼€å§‹ï¼Œä¸æ­£å¸¸å¾®è°ƒæ—¶çš„æƒ…å†µç›¸åŒã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬å°†ç»„å¤§å°å¢åŠ åˆ° 2æ—¶ï¼ŒæŸå¤±è·³å‡åˆ°å¤§çº¦ 11ã€‚è¿™è¡¨æ˜å³ä½¿ç»„å¤§å°æœ€å°ä¸º 2ï¼Œæ¨¡å‹ä»å‡ ä¹å¤±å»äº†æ‰€æœ‰ä¿¡æ¯ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è€ƒè™‘é€æ¸å¼•å…¥é‡åŒ–è€Œä¸æ˜¯çªç„¶å°†å…¶åº”ç”¨äºæ¯ä¸ªå¼ é‡çš„æƒé‡å’Œæ¿€æ´»ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ª lambda å€¼æ¥æ§åˆ¶è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">lambda_</span> <span class="o">=</span> <span class="err">?</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">x_quant</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="p">(</span><span class="n">activation_quant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">w_quant</span> <span class="o">=</span> <span class="n">w</span> <span class="o">+</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight_quant</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
</span></code></pre></div>
<p>å½“<code>lambda</code>è®¾ç½®ä¸º0æ˜¯, å®é™…ä¸Šæ²¡æœ‰é‡åŒ–å‘ç”Ÿ, å½“<code>lambda=1</code>æ—¶, å°†åº”ç”¨å®Œå…¨çš„é‡åŒ–.</p>
<p>æˆ‘ä»¬æœ€åˆæµ‹è¯•äº†ä¸€äº›ç¦»æ•£çš„ lambda å€¼ï¼Œæ¯”å¦‚ 0.25ã€0.5ã€0.75 å’Œ 1ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•å¹¶æ²¡æœ‰åœ¨ç»“æœä¸Šå¸¦æ¥æ˜¾è‘—çš„æ”¹å–„ï¼Œä¸»è¦æ˜¯å› ä¸º lambda=0.25 å·²ç»è¶³å¤Ÿé«˜ï¼Œä½¿æŸå¤±å¼€å§‹å¾—å¾ˆé«˜ã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/lambda_0.25.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/lambda_0.25.png" alt="å½“lambda = 0.25-></a>0.5->0.75->1æ—¶çš„å¾®è°ƒå›¾åƒ" style="width: 100%;"/>
  <figcaption> å½“lambda = 0.25->0.5->0.75->1æ—¶çš„å¾®è°ƒå›¾åƒ </figcaption>
</figure>

<p>å› æ­¤ï¼Œæˆ‘ä»¬å†³å®šå°è¯•ä¸€ä¸ªæ ¹æ®è®­ç»ƒæ­¥éª¤åŠ¨æ€è°ƒæ•´çš„ <code>lambda</code> å€¼ã€‚</p>
<p>ä½¿ç”¨è¿™ç§åŠ¨æ€çš„ <code>lambda</code> å€¼å¯¼è‡´æ›´å¥½çš„æŸå¤±æ”¶æ•›ï¼Œä½†åœ¨æ¨ç†è¿‡ç¨‹ä¸­ï¼Œå½“ <code>lambda</code> è®¾ç½®ä¸º 1 æ—¶ï¼Œå›°æƒ‘åº¦ï¼ˆperplexityæˆ–è€…pplï¼‰çš„ç»“æœä»ç„¶è¿œéä»¤äººæ»¡æ„ã€‚æˆ‘ä»¬æ„è¯†åˆ°è¿™å¾ˆå¯èƒ½æ˜¯å› ä¸ºæ¨¡å‹åœ¨ <code>lambda=1</code> çš„æƒ…å†µä¸‹è¿˜æ²¡æœ‰å—è¿‡è¶³å¤Ÿé•¿æ—¶é—´çš„è®­ç»ƒã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è°ƒæ•´äº†æˆ‘ä»¬çš„ <code>lambda</code> å€¼æ¥æ”¹å–„è®­ç»ƒè¿‡ç¨‹ã€‚</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">lambda_</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">training_step</span> <span class="o">/</span> <span class="n">total_training_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<p>åœ¨è¿™ç§é…ç½®ä¸‹ï¼Œç»è¿‡ 2000 æ­¥ä¹‹åï¼Œæˆ‘ä»¬æœ‰:</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/lambda_training_step.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/lambda_training_step.png" alt="lambda = min(2*training_step/total_training_steps, 1)æ—¶çš„å¾®è°ƒå›¾åƒ" style="width: 100%;"/></a>
  <figcaption> lambda = min(2*training_step/total_training_steps, 1)æ—¶çš„å¾®è°ƒå›¾åƒ </figcaption>
</figure>

<p>æˆ‘ä»¬çš„å¾®è°ƒæ–¹æ³•æ•´ä½“ä¸Šæ˜¾ç¤ºå‡ºæ›´å¥½çš„æ”¶æ•›æ€§ã€‚ä½ å¯ä»¥è§‚å¯Ÿåˆ°åœ¨å¤§çº¦ 1000 æ­¥æ—¶æŸå¤±æ›²çº¿ç•¥å¾®å¢åŠ ï¼Œè¿™å¯¹åº”äºæˆ‘ä»¬å¼€å§‹æ¥è¿‘ <code>lambda=1</code> æˆ–å®Œå…¨é‡åŒ–çš„æ—¶å€™ã€‚ç„¶è€Œï¼Œåœ¨è¿™ä¸€ç‚¹ä¹‹åï¼ŒæŸå¤±ç«‹å³å¼€å§‹å†æ¬¡æ”¶æ•›ï¼Œå¯¼è‡´å›°æƒ‘åº¦çº¦ä¸º 4ï¼Œå¾—åˆ°äº†æ”¹å–„ã€‚</p>
<p>å°½ç®¡å–å¾—äº†è¿›å±•ï¼Œä½†å½“æˆ‘ä»¬åœ¨ WikiText æ•°æ®é›†ä¸Šæµ‹è¯•é‡åŒ–æ¨¡å‹ï¼ˆè€Œä¸æ˜¯æˆ‘ä»¬ç”¨äºå¾®è°ƒçš„ tinystories æ•°æ®é›†ï¼‰æ—¶ï¼Œå›°æƒ‘åº¦éå¸¸é«˜ã€‚è¿™è¡¨æ˜åœ¨ç‰¹å®šæ•°æ®é›†ä¸Šä»¥ä½æ¯”ç‰¹æ¨¡å¼å¾®è°ƒæ¨¡å‹ä¼šå¯¼è‡´å…¶ä¸§å¤±å¤§éƒ¨åˆ†é€šç”¨çŸ¥è¯†ã€‚è¿™ä¸ªé—®é¢˜å¯èƒ½æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ä¸‰å€¼æƒé‡ä¸­è¿½æ±‚çš„æœ€å°è¡¨ç¤ºåœ¨ä¸åŒæ•°æ®é›†ä¹‹é—´å¯èƒ½ä¼šæœ‰æ˜¾è‘—å·®å¼‚ã€‚ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ‰©å±•äº†æˆ‘ä»¬çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒåŒ…æ‹¬äº†æ›´å¤§çš„<a href="https://huggingface.co/datasets/HuggingFaceFW/fineweb">FineWeb-edu</a> æ•°æ®é›†ã€‚æˆ‘ä»¬ä¿æŒäº†ä¸€ä¸ª <code>lambda</code> å€¼ä¸º:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">lambda_</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">training_step</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<p>æˆ‘ä»¬é€‰æ‹©äº†è¿™ä¸ª <code>lambda</code> å€¼ï¼Œå› ä¸ºå®ƒä¼¼ä¹æ˜¯å¯¹æ¨¡å‹è¿›è¡Œwarmupçš„ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚ç„¶åï¼Œæˆ‘ä»¬åœ¨ FineWeb-edu æ•°æ®é›†ä¸Šä½¿ç”¨å­¦ä¹ ç‡ä¸º 1e-4ï¼Œè®­ç»ƒäº†5000æ­¥ã€‚è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨äº†ä¸€ä¸ªæ‰¹é‡å¤§å°ï¼ˆBSï¼‰ä¸º 2Bï¼Œæ€»å…±è®­ç»ƒäº†10Bä¸ªtokenã€‚</p>
<p>æ‰¾åˆ°åˆé€‚çš„å­¦ä¹ ç‡å’Œåˆé€‚çš„è¡°å‡ç‡æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ï¼›è¿™ä¼¼ä¹æ˜¯æ¨¡å‹æ€§èƒ½çš„ä¸€ä¸ªå…³é”®å› ç´ ã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/fineweb-edu.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/fineweb-edu.png" alt="åœ¨Fineweb-eduä¸Šè¿›è¡Œwarmupé‡åŒ–æ—¶çš„å¾®è°ƒå›¾åƒ" style="width: 100%;"/></a>
  <figcaption> åœ¨Fineweb-eduä¸Šè¿›è¡Œwarmupé‡åŒ–æ—¶çš„å¾®è°ƒå›¾åƒ </figcaption>
</figure>

<p>åœ¨ FineWeb-Eduä¸Šå¾®è°ƒåï¼Œåœ¨ WikiText æ•°æ®é›†ä¸Šè¾¾åˆ° 12.2 çš„å›°æƒ‘åº¦æ˜¯ç›¸å½“ä»¤äººå°è±¡æ·±åˆ»çš„ï¼Œè€ƒè™‘åˆ°æˆ‘ä»¬åªä½¿ç”¨äº† 100 äº¿ä¸ªæ ‡è®°ã€‚å…¶ä»–è¯„ä¼°æŒ‡æ ‡ä¹Ÿæ˜¾ç¤ºå‡ºäº†å¼ºå¤§çš„æ€§èƒ½ï¼Œè€ƒè™‘åˆ°æ•°æ®é‡æœ‰é™ï¼ˆè¯·å‚è§ç»“æœï¼‰ã€‚</p>
<p>å°è¯•å¹³æ»‘ lambda æ¥è¿‘1æ—¶çš„æ€¥å‰§å¢åŠ ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„æƒ³æ³•ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œè€ƒè™‘ä½¿ç”¨ lambda è°ƒåº¦å™¨ï¼Œè¿™äº›è°ƒåº¦å™¨åœ¨å¼€å§‹æ—¶å‘ˆæŒ‡æ•°å¢é•¿ï¼Œç„¶ååœ¨æ¥è¿‘ 1 æ—¶è¶‹äºå¹³ç¨³ã€‚è¿™ç§æ–¹æ³•å¯ä»¥å¸®åŠ©æ¨¡å‹æ›´å¹³ç¨³åœ°é€‚åº” lambda å€¼çš„å˜åŒ–ï¼Œé¿å…çªç„¶çš„æ³¢åŠ¨ã€‚</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">def</span> <span class="nf">scheduler</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">total_steps</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">normalized_step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">/</span> <span class="n">total_steps</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">normalized_step</span><span class="p">)</span><span class="o">**</span><span class="n">k</span>
</span></code></pre></div>
<p>å¯¹äºä¸åŒçš„ k å€¼ï¼Œæ€»é¢„çƒ­æ­¥æ•°ä¸º 1ï¼Œæˆ‘ä»¬æœ‰å¦‚ä¸‹å›¾è¡¨ï¼š</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/exp_scheduler.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/exp_scheduler.png" alt="ä¸åŒkå€¼æ—¶çš„æŒ‡æ•°è°ƒåº¦å™¨" style="width: 100%;"/></a>
  <figcaption>ä¸åŒkå€¼æ—¶çš„æŒ‡æ•°è°ƒåº¦å™¨</figcaption>
</figure>

<p>æˆ‘ä»¬ä½¿ç”¨è¡¨ç°æœ€å¥½çš„å­¦ä¹ ç‡ 1e-4è¿›è¡Œäº†4æ¬¡å®éªŒ, æµ‹è¯•çš„kå€¼åˆ†åˆ«ä¸º4, 6, 8, 10.</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/exp_scheduler_results.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/exp_scheduler_results.png" alt="ä½¿ç”¨ä¸åŒæŒ‡æ•°è°ƒåº¦å™¨æ—¶çš„å¾®è°ƒå›¾åƒ" style="width: 100%;"/></a>
  <figcaption>ä½¿ç”¨ä¸åŒæŒ‡æ•°è°ƒåº¦å™¨æ—¶çš„å¾®è°ƒå›¾åƒ</figcaption>
</figure>

<p>å¹³æ»‘æ•ˆæœå¾ˆå¥½ï¼Œä¸åƒçº¿æ€§è°ƒåº¦å™¨é‚£æ ·å‡ºç°å°–å³°ã€‚ç„¶è€Œï¼Œå›°æƒ‘åº¦å¹¶ä¸ç†æƒ³ï¼Œå¤§çº¦ä¿æŒåœ¨ 15 å·¦å³ï¼Œå¯¹ä¸‹æ¸¸ä»»åŠ¡çš„è¡¨ç°ä¹Ÿæ²¡æœ‰æ”¹å–„ã€‚</p>
<p>æˆ‘ä»¬è¿˜æ³¨æ„åˆ°äº†å¼€å§‹æ—¶çš„å°–å³°ï¼Œæ¨¡å‹éš¾ä»¥ä»ä¸­æ¢å¤ã€‚å½“ lambda = 0 æ—¶ï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰é‡åŒ–ï¼Œæ‰€ä»¥æŸå¤±å¼€å§‹å¾ˆä½ï¼Œå¤§çº¦åœ¨ 2 å·¦å³ã€‚ä½†åœ¨ç¬¬ä¸€æ­¥ä¹‹åï¼Œå‡ºç°äº†ä¸€ä¸ªå°–å³°ï¼Œç±»ä¼¼äºçº¿æ€§è°ƒåº¦å™¨çš„æƒ…å†µï¼ˆå¦‚ä¸Šé¢çš„è“è‰²å›¾è¡¨æ‰€ç¤ºï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°è¯•äº†å¦ä¸€ç§è°ƒåº¦å™¨å³ Sigmoid è°ƒåº¦å™¨ï¼Œå®ƒå¼€å§‹ç¼“æ…¢ä¸Šå‡ï¼Œè¿…é€Ÿä¸Šå‡åˆ° 1ï¼Œç„¶ååœ¨æ¥è¿‘ 1 æ—¶è¶‹äºç¨³å®šã€‚</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">def</span> <span class="nf">sigmoid_scheduler</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">total_steps</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    <span class="c1"># Sigmoid-like curve: slow start, fast middle, slow end</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>    <span class="n">normalized_step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">/</span> <span class="n">total_steps</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">normalized_step</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)))</span>
</span></code></pre></div>
<p>å¯¹äºä¸åŒçš„kå€¼æœ‰ä»¥ä¸‹çš„æ›²çº¿:</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/sig_scheduler.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/sig_scheduler.png" alt="å¯¹äºä¸åŒkå€¼çš„Sigmoidè°ƒåº¦å™¨" style="width: 100%;"/></a>
  <figcaption>å¯¹äºä¸åŒkå€¼çš„Sigmoidè°ƒåº¦å™¨</figcaption>
</figure>

<p>æˆ‘ä»¬è¿™æ¬¡åœ¨kä¸º15,20,25,40å’Œ100æ—¶è¿›è¡Œäº†å®éªŒ:</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/sig_scheduler_exps.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/sig_scheduler_exps.png" alt="ä½¿ç”¨Sigmoidè°ƒåº¦å™¨è¿›è¡Œå¾®è°ƒçš„å›¾åƒ" style="width: 100%;"/></a>
  <figcaption> ä½¿ç”¨Sigmoidè°ƒåº¦å™¨è¿›è¡Œå¾®è°ƒçš„å›¾åƒ </figcaption>
</figure>

<p>lambda çš„æ€¥å‰§å¢åŠ å¯¼è‡´åœ¨ç¬¬ 500 æ­¥å·¦å³å‡ºç°ä¸ç¨³å®šï¼Œå¹¶æ²¡æœ‰è§£å†³ç¬¬ä¸€æ¬¡å‘æ•£é—®é¢˜ã€‚ç„¶è€Œï¼Œå¯¹äº <span class="arithmatex">\( k = 100 \)</span>ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸­æœ‰ä¸€äº›æ”¹å–„ï¼ˆè¯·å‚é˜…ç»“æœè¡¨ï¼‰ï¼Œå°½ç®¡å›°æƒ‘åº¦ä»ä¿æŒåœ¨ 13.5 å·¦å³ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä¸çº¿æ€§è°ƒåº¦å™¨ç›¸æ¯”ï¼Œå¹¶æ²¡æœ‰æ˜¾ç¤ºæ˜æ˜¾çš„æ€§èƒ½æå‡ã€‚</p>
<p>æ­¤å¤–ï¼Œæˆ‘ä»¬å°è¯•äº†ä½¿ç”¨éšæœºæƒé‡å’Œå„ç§å­¦ä¹ ç‡ä»å¤´å¼€å§‹è®­ç»ƒæ¨¡å‹çš„å®éªŒã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ¯”è¾ƒæˆ‘ä»¬çš„å¾®è°ƒæ–¹æ³•ä¸ä¼ ç»Ÿçš„é¢„è®­ç»ƒæ–¹æ³•çš„æœ‰æ•ˆæ€§ã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/exp-randoms.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/exp-randoms.png" alt="ä¸åŒå­¦ä¹ ç‡æ—¶çš„è®­ç»ƒå›¾åƒ" style="width: 100%;"/></a>
  <figcaption>ä¸åŒå­¦ä¹ ç‡æ—¶çš„è®­ç»ƒå›¾åƒ</figcaption>
</figure>

<p>æ‰€æœ‰ä»éšæœºæƒé‡è®­ç»ƒçš„æ¨¡å‹éƒ½æ²¡æœ‰æ¯”æˆ‘ä»¬çš„å¾®è°ƒæ¨¡å‹è¡¨ç°æ›´å¥½ã€‚æˆ‘ä»¬åœ¨è¿™äº›æ¨¡å‹ä¸­å®ç°çš„æœ€ä½³å›°æƒ‘åº¦ä¸º 26ï¼Œä¸æˆ‘ä»¬çš„å¾®è°ƒæ–¹æ³•çš„ç»“æœç›¸æ¯”ç•¥é€Šä¸€ç­¹ã€‚</p>
<h3 id="100btoken">æ‰©å±•åˆ°100Bä¸ªtoken!<a class="headerlink" href="#100btoken" title="Permanent link">&para;</a></h3>
<p>æˆ‘ä»¬å°†å®éªŒæ‰©å±•åˆ°äº†100Bä¸ªtokenï¼Œä»¥æŸ¥çœ‹æ˜¯å¦èƒ½å¤Ÿè¾¾åˆ° Llama 3 8B æ¨¡å‹çš„æ€§èƒ½æ°´å¹³ã€‚æˆ‘ä»¬è¿›è¡Œäº†æ›´é•¿æ—¶é—´çš„è®­ç»ƒè¿è¡Œï¼Œä»è¾ƒçŸ­è¿è¡Œä¸­è¡¨ç°æœ€ä½³çš„æ£€æŸ¥ç‚¹å¼€å§‹ï¼Œä½¿ç”¨çº¿æ€§è°ƒåº¦å™¨ï¼Œå¹¶æŒç»­å¾®è°ƒäº† 45,000 æ­¥ã€‚æˆ‘ä»¬å°è¯•äº†ä¸åŒçš„å­¦ä¹ ç‡ï¼Œè™½ç„¶åœ¨æŸäº›æŒ‡æ ‡ä¸Šæ¨¡å‹çš„è¡¨ç°æ¥è¿‘ Llama 3 æ¨¡å‹ï¼Œä½†å¹³å‡è€Œè¨€ï¼Œä»ç„¶è½åä¸€äº›ã€‚</p>
<p>è¿™é‡Œæ˜¯æˆ‘ä»¬åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åœ¨ä¸åŒcheckpointè¯„ä¼°çš„ä¸€äº›æŒ‡æ ‡çš„ä¾‹å­ï¼š</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/metrics_100B.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/metrics_100B.png" alt="åœ¨è®­ç»ƒä¸­ä¸åŒå­¦ä¹ ç‡çš„å¤šä¸ªæŒ‡æ ‡è¯„ä¼°ç»“æœ" style="width: 100%;"/></a>
  <figcaption> åœ¨è®­ç»ƒä¸­ä¸åŒå­¦ä¹ ç‡çš„å¤šä¸ªæŒ‡æ ‡è¯„ä¼°ç»“æœ </figcaption>
</figure>

<p>å¹³å‡çš„åˆ†æ•°å¦‚ä¸‹:</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/metric_avg.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/metric_avg.png" alt="åœ¨è®­ç»ƒä¸­ä¸åŒå­¦ä¹ ç‡çš„å¹³å‡è¯„ä¼°ç»“æœ" style="width: 100%;"/></a>
  <figcaption> åœ¨è®­ç»ƒä¸­ä¸åŒå­¦ä¹ ç‡çš„å¹³å‡è¯„ä¼°ç»“æœ </figcaption>
</figure>

<h3 id="_5">åœ¨æ›´å°çš„æ¨¡å‹ä¸Šçš„å®éªŒ<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>åœ¨æˆ‘ä»¬å¯¹ SmolLM ç­‰è¾ƒå°æ¨¡å‹è¿›è¡Œçš„åˆå§‹å®éªŒä¸­ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°warmupé‡åŒ–æŠ€æœ¯å¹¶æ²¡æœ‰åƒå¯¹è¾ƒå¤§æ¨¡å‹é‚£æ ·å¸¦æ¥å¤ªå¤šæ”¹è¿›ã€‚è¿™è¡¨æ˜warmupé‡åŒ–çš„æœ‰æ•ˆæ€§å¯èƒ½ä¸æ¨¡å‹çš„å¤§å°å’Œå¤æ‚æ€§æ›´å¯†åˆ‡ç›¸å…³ã€‚</p>
<p>ä¾‹å¦‚ï¼Œè¿™é‡Œæ˜¯ <a href="https://huggingface.co/HuggingFaceTB/SmolLM-135M">SmolLM 135M</a> æ¨¡å‹çš„æŸå¤±æ›²çº¿ï¼Œæ¯”è¾ƒäº†ä»ä¸€å¼€å§‹å°±ä½¿ç”¨warmupé‡åŒ–å’Œå®Œå…¨é‡åŒ–çš„æƒ…å†µã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™äº›æ›²çº¿éå¸¸æ¥è¿‘ï¼Œå¾—åˆ°çš„å›°æƒ‘åº¦å¹¶æ²¡æœ‰æ˜¾è‘—ä¸åŒã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/smol_llm_exp.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/smol_llm_exp.png" alt="æœ‰warmupé‡åŒ–å’Œæ²¡æœ‰æ—¶çš„Smoll LLMå¾®è°ƒå®éªŒ" style="width: 100%;"/></a>
  <figcaption> æœ‰warmupé‡åŒ–å’Œæ²¡æœ‰æ—¶çš„Smoll LLMå¾®è°ƒå®éªŒ </figcaption>
</figure>

<h3 id="_6">å¯¹æ¯”ä¸ç»“è®º<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>BitNet åœ¨ä¸åŸºå‡†æ–¹æ³•ç›¸æ¯”è¡¨ç°å‡ºè‰²ï¼Œç‰¹åˆ«æ˜¯åœ¨è¾ƒä½æ¯”ç‰¹æ•°æƒ…å†µä¸‹ã€‚æ ¹æ®è®ºæ–‡ï¼ŒBitNet å®ç°äº†ä¸ 8 ä½æ¨¡å‹ç›¸å½“çš„åˆ†æ•°ï¼Œä½†æ¨ç†æˆæœ¬æ˜¾è‘—æ›´ä½ã€‚åœ¨ 4 ä½æ¨¡å‹çš„æƒ…å†µä¸‹ï¼Œä»…é‡åŒ–æƒé‡çš„æ–¹æ³•èƒœè¿‡åŒæ—¶é‡åŒ–æƒé‡å’Œæ¿€æ´»çš„æ–¹æ³•ï¼Œå› ä¸ºæ¿€æ´»æ›´éš¾é‡åŒ–ã€‚ç„¶è€Œï¼Œä½¿ç”¨ 1.58 ä½æƒé‡çš„ BitNet è¶…è¶Šäº†ä»…æƒé‡å’Œæƒé‡ä¸æ¿€æ´»é‡åŒ–æ–¹æ³•ã€‚</p>
<p>ä¸‹è¡¨å±•ç¤ºäº†åœ¨ Llama3 8B çš„ 10Bä¸ªtoken å¾®è°ƒè¿‡ç¨‹ä¹‹åå„ç§æŒ‡æ ‡çš„ç»“æœã€‚è¿™äº›ç»“æœä¸å…¶ä»–æ¨¡å‹æ¶æ„çš„ç»“æœè¿›è¡Œäº†æ¯”è¾ƒï¼Œä»¥æä¾›å¯¹æ€§èƒ½çš„å…¨é¢æ¦‚è¿°ï¼ˆæ‰€æœ‰è¯„ä¼°å‡ä½¿ç”¨ <a href="https://github.com/huggingface/lighteval">Lighteval</a> åœ¨ <a href="https://github.com/huggingface/nanotron">Nanotron</a> æ ¼å¼æ¨¡å‹ä¸Šè¿›è¡Œï¼‰ã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/metrics_comparison_updated.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/metrics_comparison_updated.png" alt="ä¸ Llama æ¨¡å‹çš„æŒ‡æ ‡æ¯”è¾ƒ" style="width: 100%;"/></a>
  <figcaption>ä¸ Llama æ¨¡å‹çš„æŒ‡æ ‡æ¯”è¾ƒï¼šçº¿æ€§è¡¨ç¤ºçº¿æ€§lambdaè°ƒåº¦å™¨ï¼ŒSigmoidè¡¨ç¤º Sigmoidè°ƒåº¦å™¨ï¼ˆåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ k = 100ï¼‰</figcaption>
</figure>

<p>åœ¨ä»…ä½¿ç”¨ä¸‰å€¼æƒé‡è¿›è¡Œ 10B ä¸ª token å¾®è°ƒåï¼Œè¯¥æ¨¡å‹å±•ç°å‡ºä»¤äººå°è±¡æ·±åˆ»çš„æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯ä¸ç»å†äº†æ›´åŠ å¹¿æ³›è®­ç»ƒçš„å…¶ä»–æ¨¡å‹ç›¸æ¯”ã€‚ä¾‹å¦‚ï¼Œå®ƒèƒœè¿‡äº†åœ¨æ•°æ®é›†è§„æ¨¡æ˜¾è‘—å¤§å¾—å¤šçš„100Bä¸ªtokenä¸Šè®­ç»ƒçš„ Bitnet 7B æ¨¡å‹ã€‚æ­¤å¤–ï¼Œå®ƒçš„è¡¨ç°ä¹Ÿä¼˜äº FBI LLMï¼ˆFully Binarized LLMï¼‰æ¨¡å‹ï¼Œåè€…åœ¨æ›´åºå¤§çš„ 1.26T ä¸ª token ä¸Šè¿›è¡Œäº†è’¸é¦ã€‚è¿™çªæ˜¾äº†è¯¥æ¨¡å‹çš„æ•ˆç‡å’Œæœ‰æ•ˆæ€§ï¼Œå°½ç®¡å…¶å¾®è°ƒè¿‡ç¨‹ç›¸å¯¹è§„æ¨¡è¾ƒå°ã€‚</p>
<p>å¯¹äº 100B ä¸ª token çš„å®éªŒï¼Œæˆ‘ä»¬æ‹¥æœ‰çš„è¡¨ç°æœ€ä½³çš„checkpointå¦‚ä¸‹ï¼š</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/metrics_100B_table.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/metrics_100B_table.png" alt="100Bä¸ªtokenå¾®è°ƒåä¸ Llama æ¨¡å‹çš„æŒ‡æ ‡æ¯”è¾ƒ" style="width: 100%;"/></a>
  <figcaption>100Bä¸ªtokenå¾®è°ƒåä¸ Llama æ¨¡å‹çš„æŒ‡æ ‡æ¯”è¾ƒ</figcaption>
</figure>

<p>è¦å¤åˆ¶è¿™äº›ç»“æœï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹è¿™ä¸ª<a href="https://github.com/huggingface/nanotron/pull/174">PR</a>å°†æ¨¡å‹è½¬æ¢ä¸º Nanotron æ ¼å¼ï¼Œè§£å‹æƒé‡ï¼ˆæ£€æŸ¥å‡½æ•°<a href="https://gist.github.com/MekkCyber/78c1532e8767e8da0588b778faf61866">unpack_weights</a>ï¼‰ï¼Œå¹¶ä½¿ç”¨ lightevalã€‚</p>
<p>è¯·æ³¨æ„ï¼Œå°½ç®¡è¿™äº›æ¨¡å‹æ˜¯ä»ä¸€ä¸ª Instruct-tuned æ¨¡å‹å¾®è°ƒè€Œæ¥ï¼Œå®ƒä»¬ä»éœ€è¦ä½¿ç”¨ Instruct æ•°æ®é›†è¿›è¡Œå¾®è°ƒã€‚è¿™äº›å¯ä»¥è¢«è§†ä¸ºåŸºç¡€æ¨¡å‹ã€‚</p>
<h2 id="_7">ä½¿ç”¨çš„ç®—å­å’Œæµ‹è¯•æ ‡å‡†<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<p>ä¸ºäº†ä» BitNet ä½ç²¾åº¦æƒé‡ä¸­å—ç›Šï¼Œæˆ‘ä»¬å°†å®ƒä»¬æ‰“åŒ…æˆä¸€ä¸ª<code>int8</code> å¼ é‡ï¼ˆè¿™ä½¿å¾—å‚æ•°æ•°é‡ä» 80 Bé™è‡³ 28 Bï¼ï¼‰ã€‚åœ¨æ¨ç†è¿‡ç¨‹ä¸­ï¼Œè¿™äº›æƒé‡åœ¨æ‰§è¡ŒçŸ©é˜µä¹˜æ³•ä¹‹å‰å¿…é¡»è¿›è¡Œè§£åŒ…ã€‚æˆ‘ä»¬åœ¨ Cuda å’Œ Triton ä¸­å®ç°äº†è‡ªå®šä¹‰å†…æ ¸ï¼Œä»¥å¤„ç†çŸ©é˜µä¹˜æ³•è¿‡ç¨‹ä¸­çš„å³æ—¶è§£åŒ…ã€‚å¯¹äºçŸ©é˜µä¹˜æ³•æœ¬èº«ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ç¼“å­˜åˆ†å—çŸ©é˜µä¹˜æ³•æŠ€æœ¯ã€‚ä¸ºäº†å……åˆ†ç†è§£è¿™ç§æ–¹æ³•ï¼Œè®©æˆ‘ä»¬é¦–å…ˆå›é¡¾ä¸€äº› Cuda ç¼–ç¨‹åŸºç¡€çŸ¥è¯†ã€‚</p>
<h3 id="gpu">åŸºç¡€çš„GPUæ¦‚å¿µ: çº¿ç¨‹, å—, å’Œå…±äº«å†…å­˜<a class="headerlink" href="#gpu" title="Permanent link">&para;</a></h3>
<p>åœ¨æ·±å…¥äº†è§£ç¼“å­˜åˆ†å—çŸ©é˜µä¹˜æ³•ä¹‹å‰ï¼Œäº†è§£ä¸€äº›åŸºæœ¬çš„ GPU æ¦‚å¿µæ˜¯å¾ˆé‡è¦çš„ï¼š</p>
<ul>
<li><strong>çº¿ç¨‹(thread)å’Œå—(block)</strong>ï¼šGPU åŒæ—¶æ‰§è¡Œæˆåƒä¸Šä¸‡ä¸ªçº¿ç¨‹ã€‚è¿™äº›çº¿ç¨‹è¢«åˆ†ç»„æˆå—ï¼Œæ¯ä¸ªå—ç‹¬ç«‹è¿è¡Œã€‚ç½‘æ ¼ç”±è¿™äº›å—(grid)ç»„æˆï¼Œä»£è¡¨æ•´ä¸ªç¨‹åºç©ºé—´ã€‚ä¾‹å¦‚ï¼Œåœ¨çŸ©é˜µä¹˜æ³•ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹å¯èƒ½è´Ÿè´£è®¡ç®—è¾“å‡ºçŸ©é˜µçš„ä¸€ä¸ªå•å…ƒã€‚</li>
<li><strong>å…±äº«å†…å­˜(share memory)</strong>ï¼šæ¯ä¸ªå—éƒ½å¯ä»¥è®¿é—®æœ‰é™é‡çš„å…±äº«å†…å­˜ï¼Œæ¯”å…¨å±€å†…å­˜ï¼ˆglobal memory, GPU ä¸Šçš„ä¸»å†…å­˜ï¼‰è¦å¿«å¾—å¤šã€‚ç„¶è€Œï¼Œå…±äº«å†…å­˜å¤§å°æœ‰é™ï¼Œå¹¶åœ¨å—å†…çš„æ‰€æœ‰çº¿ç¨‹ä¹‹é—´å…±äº«ã€‚æœ‰æ•ˆåˆ©ç”¨å…±äº«å†…å­˜æ˜¯æé«˜ GPU ç¨‹åºæ€§èƒ½çš„å…³é”®ã€‚</li>
</ul>
<h3 id="_8">çŸ©é˜µä¹˜æ³•ä¸­çš„æŒ‘æˆ˜<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>åœ¨ GPU ä¸Šç®€å•å®ç°çŸ©é˜µä¹˜æ³•å¯èƒ½æ¶‰åŠæ¯ä¸ªçº¿ç¨‹é€šè¿‡ç›´æ¥ä»å…¨å±€å†…å­˜è¯»å–æ‰€éœ€å…ƒç´ æ¥è®¡ç®—ç»“æœçŸ©é˜µçš„å•ä¸ªå…ƒç´ ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•å¯èƒ½æ•ˆç‡ä½ä¸‹ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>å†…å­˜å¸¦å®½</strong>ï¼šç›¸å¯¹äº GPU æ ¸å¿ƒæ‰§è¡Œè®¡ç®—çš„é€Ÿåº¦ï¼Œè®¿é—®å…¨å±€å†…å­˜ç›¸å¯¹è¾ƒæ…¢ã€‚å¦‚æœæ¯ä¸ªçº¿ç¨‹ç›´æ¥ä»å…¨å±€å†…å­˜è¯»å–çŸ©é˜µå…ƒç´ ï¼Œè®¿å­˜æ—¶é—´å¯èƒ½æˆä¸ºç“¶é¢ˆã€‚</li>
<li><strong>å†—ä½™æ•°æ®è®¿é—®</strong>ï¼šåœ¨çŸ©é˜µä¹˜æ³•ä¸­ï¼Œè¾“å…¥çŸ©é˜µçš„è®¸å¤šå…ƒç´ è¢«å¤šæ¬¡ä½¿ç”¨ã€‚å¦‚æœæ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹ä»å…¨å±€å†…å­˜è·å–æ‰€éœ€æ•°æ®ï¼Œç›¸åŒçš„æ•°æ®å¯èƒ½ä¼šè¢«å¤šæ¬¡åŠ è½½åˆ° GPU ä¸­ï¼Œå¯¼è‡´æ•ˆç‡ä½ä¸‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ¯ä¸ªçº¿ç¨‹ç”¨äºè®¡ç®—è¾“å‡ºçŸ©é˜µä¸­çš„å•ä¸ªå…ƒç´ ï¼Œåˆ™è´Ÿè´£è®¡ç®—ä½ç½® (i, j) çš„çº¿ç¨‹å°†éœ€è¦ä»å…¨å±€å†…å­˜åŠ è½½çŸ©é˜µ A çš„ç¬¬ i è¡Œå’ŒçŸ©é˜µ B çš„ç¬¬ j åˆ—ã€‚ç„¶è€Œï¼Œå…¶ä»–çº¿ç¨‹ï¼Œä¾‹å¦‚è´Ÿè´£è®¡ç®—ä½ç½® (i+1, j) çš„çº¿ç¨‹ï¼Œæ— æ³•é‡ç”¨è¿™äº›æ•°æ®ï¼Œå°†ä¸å¾—ä¸å†æ¬¡ä»å…¨å±€å†…å­˜ä¸­åŠ è½½ç›¸åŒçš„ç¬¬ j åˆ—ã€‚</li>
</ul>
<h3 id="_9">åˆ†å—çš„æ¦‚å¿µ<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>åˆ†å—æ˜¯ä¸€ç§ç”¨äºè§£å†³è¿™äº›æŒ‘æˆ˜çš„æŠ€æœ¯ï¼Œä¸»è¦ç”¨äº FlashAttention æŠ€æœ¯ä¸­ä»¥æé«˜å†…æ ¸çš„æ•ˆç‡ã€‚åŸºæœ¬æ€æƒ³æ˜¯å°†çŸ©é˜µåˆ†æˆæ›´å°çš„å­çŸ©é˜µï¼Œç§°ä¸ºå—(tile)ï¼Œè¿™äº›å—å¯ä»¥é€‚åº” GPU çš„å…±äº«å†…å­˜ã€‚è®¡ç®—ä¸å†ä¸€æ¬¡å®Œæˆæ•´ä¸ªè¾“å‡ºçŸ©é˜µï¼Œè€Œæ˜¯å°†è®¡ç®—åˆ†è§£ä¸ºå°å—ï¼Œé€å—å¤„ç†ã€‚</p>
<p>åœ¨çŸ©é˜µä¹˜æ³•çš„èƒŒæ™¯ä¸‹ï¼Œè¿™æ„å‘³ç€å°†çŸ©é˜µ A å’Œ B åˆ’åˆ†ä¸ºå—ï¼Œå°†è¿™äº›å—åŠ è½½åˆ°å…±äº«å†…å­˜ä¸­ï¼Œç„¶ååœ¨è¿™äº›è¾ƒå°çš„å—ä¸Šæ‰§è¡Œä¹˜æ³•ã€‚è¿™ç§æ–¹æ³•å…è®¸çº¿ç¨‹é‡å¤ä½¿ç”¨å­˜å‚¨åœ¨å¿«é€Ÿå…±äº«å†…å­˜ä¸­çš„æ•°æ®ï¼Œå‡å°‘äº†é‡å¤è®¿é—®å…¨å±€å†…å­˜çš„éœ€æ±‚ã€‚</p>
<p>å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>å°†å—åŠ è½½åˆ°å…±äº«å†…å­˜</strong>ï¼šæ¯ä¸ªçº¿ç¨‹å—ååŒåœ°å°†çŸ©é˜µ A çš„ä¸€ä¸ªå°å—å’Œç›¸åº”çš„çŸ©é˜µ B çš„ä¸€ä¸ªå°å—ä»å…¨å±€å†…å­˜åŠ è½½åˆ°å…±äº«å†…å­˜ã€‚è¿™ä¸ªæ“ä½œå¯¹æ¯ä¸ªå°å—åªæ‰§è¡Œä¸€æ¬¡ï¼Œç„¶åè¯¥å°å—è¢«å—ä¸­çš„çº¿ç¨‹å¤šæ¬¡é‡å¤ä½¿ç”¨ã€‚</li>
<li><strong>è®¡ç®—éƒ¨åˆ†ä¹˜ç§¯</strong>ï¼šä¸€æ—¦å—åŠ è½½åˆ°å…±äº«å†…å­˜ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹è®¡ç®—éƒ¨åˆ†ä¹˜ç§¯ã€‚ç”±äºå—ä¸­çš„æ‰€æœ‰çº¿ç¨‹éƒ½åœ¨å…±äº«å†…å­˜ä¸­çš„ç›¸åŒå—ä¸Šå·¥ä½œï¼Œå®ƒä»¬å¯ä»¥æœ‰æ•ˆåœ°é‡å¤ä½¿ç”¨æ•°æ®ï¼Œè€Œæ— éœ€é¢å¤–è®¿é—®å…¨å±€å†…å­˜ã€‚</li>
<li><strong>ç´¯ç§¯ç»“æœ</strong>ï¼šè®¡ç®—å®Œä¸€ä¸ªå—çš„éƒ¨åˆ†ä¹˜ç§¯åï¼Œçº¿ç¨‹å°†ä»çŸ©é˜µ A å’Œ B ä¸­åŠ è½½ä¸‹ä¸€ä¸ªå—åˆ°å…±äº«å†…å­˜ï¼Œå¹¶é‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚ç»“æœç´¯ç§¯åœ¨å¯„å­˜å™¨ï¼ˆæˆ–æœ¬åœ°å†…å­˜ï¼‰ä¸­ï¼Œä¸€æ—¦æ‰€æœ‰å—éƒ½è¢«å¤„ç†ï¼Œè¾“å‡ºçŸ©é˜µå…ƒç´ çš„æœ€ç»ˆå€¼å°†è¢«å†™å›å…¨å±€å†…å­˜ã€‚</li>
</ul>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/illustration_tiling.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/illustration_tiling.png" alt="åˆ†å—çŸ©é˜µä¹˜æ³•å›¾ç¤º" style="width: 100%;"/></a>
  <figcaption>åˆ†å—çŸ©é˜µä¹˜æ³•å›¾ç¤º (æ¥æº https://cnugteren.github.io/tutorial/pages/page4.html)</figcaption>
</figure>

<p><strong>ç°å®çš„è€ƒè™‘</strong></p>
<p>åœ¨å®ç°ç¼“å­˜åˆ†å—çŸ©é˜µä¹˜æ³•æ—¶ï¼Œè€ƒè™‘äº†å‡ ä¸ªå› ç´ ï¼š</p>
<ul>
<li><strong>å—å¤§å°</strong>ï¼šå—çš„å¤§å°åº”è¯¥é€‰æ‹©ä»¥å¹³è¡¡èƒ½å¤Ÿæ”¾å…¥å…±äº«å†…å­˜çš„æ•°æ®é‡å’Œå…¨å±€å†…å­˜è®¿é—®æ¬¡æ•°ä¹‹é—´çš„æƒè¡¡ã€‚</li>
<li><strong>å†…å­˜åˆå¹¶</strong>ï¼šå…¨å±€å†…å­˜è®¿é—®åº”è¯¥è¿›è¡Œå†…å­˜åˆå¹¶ï¼Œè¿™æ„å‘³ç€ç›¸é‚»çš„çº¿ç¨‹è®¿é—®ç›¸é‚»çš„å†…å­˜ä½ç½®ã€‚</li>
<li><strong>å ç”¨ç‡</strong>ï¼šåº”è¯¥é€‰æ‹©æ¯ä¸ªå—ä¸­çš„çº¿ç¨‹æ•°å’Œç½‘æ ¼ä¸­çš„å—æ•°ï¼Œä»¥ç¡®ä¿é«˜å ç”¨ç‡ï¼Œå³åœ¨ GPU ä¸Šæœ‰å°½å¯èƒ½å¤šçš„æ´»åŠ¨çº¿ç¨‹æŸ(warp)ï¼ˆä¸€ä¸ªçº¿ç¨‹æŸæ˜¯ä¸€ç»„ 32 ä¸ªçº¿ç¨‹ï¼‰ï¼Œä»¥éšè—å†…å­˜å»¶è¿Ÿã€‚</li>
</ul>
<h3 id="triton">Tritonç®—å­<a class="headerlink" href="#triton" title="Permanent link">&para;</a></h3>
<p>ä¸‹é¢æ˜¯æˆ‘ä»¬ä½œä¸ºåŸºå‡†çš„ä¸€ä¸ªtritonç®—å­:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nd">@triton</span><span class="o">.</span><span class="n">autotune</span><span class="p">(</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="n">configs</span><span class="o">=</span><span class="n">get_cuda_autotune_config</span><span class="p">(),</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">],</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="p">)</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="nd">@triton</span><span class="o">.</span><span class="n">jit</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="k">def</span> <span class="nf">matmul_kernel</span><span class="p">(</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>        <span class="n">a_ptr</span><span class="p">,</span> <span class="n">b_ptr</span><span class="p">,</span> <span class="n">c_ptr</span><span class="p">,</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>        <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>        <span class="n">stride_am</span><span class="p">,</span> <span class="n">stride_ak</span><span class="p">,</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>        <span class="n">stride_bk</span><span class="p">,</span> <span class="n">stride_bn</span><span class="p">,</span> 
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>        <span class="n">stride_cm</span><span class="p">,</span> <span class="n">stride_cn</span><span class="p">,</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>        <span class="n">BLOCK_SIZE_M</span><span class="p">:</span> <span class="n">tl</span><span class="o">.</span><span class="n">constexpr</span><span class="p">,</span> <span class="n">BLOCK_SIZE_N</span><span class="p">:</span> <span class="n">tl</span><span class="o">.</span><span class="n">constexpr</span><span class="p">,</span> <span class="n">BLOCK_SIZE_K</span><span class="p">:</span> <span class="n">tl</span><span class="o">.</span><span class="n">constexpr</span><span class="p">,</span>  
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>        <span class="n">GROUP_SIZE_M</span><span class="p">:</span> <span class="n">tl</span><span class="o">.</span><span class="n">constexpr</span><span class="p">,</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="p">):</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>    <span class="n">pid</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">program_id</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>    <span class="n">num_pid_m</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">cdiv</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">BLOCK_SIZE_M</span><span class="p">)</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>    <span class="n">num_pid_n</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">cdiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">BLOCK_SIZE_N</span><span class="p">)</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>    <span class="n">num_pid_in_group</span> <span class="o">=</span> <span class="n">GROUP_SIZE_M</span> <span class="o">*</span> <span class="n">num_pid_n</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>    <span class="n">group_id</span> <span class="o">=</span> <span class="n">pid</span> <span class="o">//</span> <span class="n">num_pid_in_group</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>    <span class="n">first_pid_m</span> <span class="o">=</span> <span class="n">group_id</span> <span class="o">*</span> <span class="n">GROUP_SIZE_M</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>    <span class="n">group_size_m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">num_pid_m</span> <span class="o">-</span> <span class="n">first_pid_m</span><span class="p">,</span> <span class="n">GROUP_SIZE_M</span><span class="p">)</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>    <span class="n">pid_m</span> <span class="o">=</span> <span class="n">first_pid_m</span> <span class="o">+</span> <span class="p">((</span><span class="n">pid</span> <span class="o">%</span> <span class="n">num_pid_in_group</span><span class="p">)</span> <span class="o">%</span> <span class="n">group_size_m</span><span class="p">)</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>    <span class="n">pid_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">pid</span> <span class="o">%</span> <span class="n">num_pid_in_group</span><span class="p">)</span> <span class="o">//</span> <span class="n">group_size_m</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>    <span class="n">offs_am</span> <span class="o">=</span> <span class="p">(</span><span class="n">pid_m</span> <span class="o">*</span> <span class="n">BLOCK_SIZE_M</span> <span class="o">+</span> <span class="n">tl</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">BLOCK_SIZE_M</span><span class="p">))</span> <span class="o">%</span> <span class="n">M</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>    <span class="n">offs_bn</span> <span class="o">=</span> <span class="p">(</span><span class="n">pid_n</span> <span class="o">*</span> <span class="n">BLOCK_SIZE_N</span> <span class="o">+</span> <span class="n">tl</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">BLOCK_SIZE_N</span><span class="p">))</span> <span class="o">%</span> <span class="n">N</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a>    <span class="n">offs_k</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">BLOCK_SIZE_K</span><span class="p">)</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a>    <span class="n">a_ptrs</span> <span class="o">=</span> <span class="n">a_ptr</span> <span class="o">+</span> <span class="p">(</span><span class="n">offs_am</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">stride_am</span> <span class="o">+</span> <span class="n">offs_k</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">stride_ak</span><span class="p">)</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a>    <span class="n">b_ptrs</span> <span class="o">=</span> <span class="n">b_ptr</span> <span class="o">+</span> <span class="p">(</span><span class="n">offs_k</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">stride_bk</span> <span class="o">+</span> <span class="n">offs_bn</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">stride_bn</span><span class="p">)</span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a>    <span class="n">accumulator</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">BLOCK_SIZE_M</span><span class="p">,</span> <span class="n">BLOCK_SIZE_N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tl</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">:</span> 
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a>        <span class="n">b_ptrs</span> <span class="o">=</span> <span class="n">b_ptr</span> <span class="o">+</span> <span class="p">(</span><span class="n">offs_k</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">stride_bk</span> <span class="o">+</span> <span class="n">offs_bn</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">stride_bn</span><span class="p">)</span>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tl</span><span class="o">.</span><span class="n">cdiv</span><span class="p">(</span><span class="n">K</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">BLOCK_SIZE_K</span><span class="p">)</span> <span class="p">):</span>
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a>            <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">tl</span><span class="o">.</span><span class="n">cdiv</span><span class="p">(</span><span class="n">K</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">BLOCK_SIZE_K</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span> 
</span><span id="__span-9-38"><a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a>
</span><span id="__span-9-39"><a id="__codelineno-9-39" name="__codelineno-9-39" href="#__codelineno-9-39"></a>            <span class="c1"># BLOCK_SIZE_K must be a divisor of K / 4 </span>
</span><span id="__span-9-40"><a id="__codelineno-9-40" name="__codelineno-9-40" href="#__codelineno-9-40"></a>            <span class="n">a</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">a_ptrs</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">offs_k</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&lt;</span> <span class="n">K</span> <span class="o">-</span> <span class="n">k</span> <span class="o">*</span> <span class="n">BLOCK_SIZE_K</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-9-41"><a id="__codelineno-9-41" name="__codelineno-9-41" href="#__codelineno-9-41"></a>            <span class="n">b_uint8</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">b_ptrs</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">offs_k</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">K</span> <span class="o">//</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">j</span> <span class="o">*</span> <span class="n">BLOCK_SIZE_K</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-9-42"><a id="__codelineno-9-42" name="__codelineno-9-42" href="#__codelineno-9-42"></a>            <span class="n">mask</span> <span class="o">=</span> <span class="mi">3</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-9-43"><a id="__codelineno-9-43" name="__codelineno-9-43" href="#__codelineno-9-43"></a>            <span class="n">b</span> <span class="o">=</span> <span class="p">((</span><span class="n">b_uint8</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
</span><span id="__span-9-44"><a id="__codelineno-9-44" name="__codelineno-9-44" href="#__codelineno-9-44"></a>
</span><span id="__span-9-45"><a id="__codelineno-9-45" name="__codelineno-9-45" href="#__codelineno-9-45"></a>            <span class="c1"># We accumulate the tiles along the K dimension.</span>
</span><span id="__span-9-46"><a id="__codelineno-9-46" name="__codelineno-9-46" href="#__codelineno-9-46"></a>            <span class="n">tensor_full</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tl</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
</span><span id="__span-9-47"><a id="__codelineno-9-47" name="__codelineno-9-47" href="#__codelineno-9-47"></a>
</span><span id="__span-9-48"><a id="__codelineno-9-48" name="__codelineno-9-48" href="#__codelineno-9-48"></a>            <span class="n">accumulator</span> <span class="o">+=</span> <span class="n">tl</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">tl</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span> <span class="o">-</span> <span class="n">tensor_full</span><span class="p">),</span> <span class="n">out_dtype</span><span class="o">=</span><span class="n">tl</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="__span-9-49"><a id="__codelineno-9-49" name="__codelineno-9-49" href="#__codelineno-9-49"></a>
</span><span id="__span-9-50"><a id="__codelineno-9-50" name="__codelineno-9-50" href="#__codelineno-9-50"></a>            <span class="n">a_ptrs</span> <span class="o">+=</span> <span class="n">BLOCK_SIZE_K</span> <span class="o">*</span> <span class="n">stride_ak</span>
</span><span id="__span-9-51"><a id="__codelineno-9-51" name="__codelineno-9-51" href="#__codelineno-9-51"></a>            <span class="n">b_ptrs</span> <span class="o">+=</span> <span class="n">BLOCK_SIZE_K</span> <span class="o">*</span> <span class="n">stride_bk</span>
</span><span id="__span-9-52"><a id="__codelineno-9-52" name="__codelineno-9-52" href="#__codelineno-9-52"></a>
</span><span id="__span-9-53"><a id="__codelineno-9-53" name="__codelineno-9-53" href="#__codelineno-9-53"></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">accumulator</span>
</span><span id="__span-9-54"><a id="__codelineno-9-54" name="__codelineno-9-54" href="#__codelineno-9-54"></a>
</span><span id="__span-9-55"><a id="__codelineno-9-55" name="__codelineno-9-55" href="#__codelineno-9-55"></a>    <span class="n">offs_cm</span> <span class="o">=</span> <span class="n">pid_m</span> <span class="o">*</span> <span class="n">BLOCK_SIZE_M</span> <span class="o">+</span> <span class="n">tl</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">BLOCK_SIZE_M</span><span class="p">)</span>
</span><span id="__span-9-56"><a id="__codelineno-9-56" name="__codelineno-9-56" href="#__codelineno-9-56"></a>    <span class="n">offs_cn</span> <span class="o">=</span> <span class="n">pid_n</span> <span class="o">*</span> <span class="n">BLOCK_SIZE_N</span> <span class="o">+</span> <span class="n">tl</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">BLOCK_SIZE_N</span><span class="p">)</span>
</span><span id="__span-9-57"><a id="__codelineno-9-57" name="__codelineno-9-57" href="#__codelineno-9-57"></a>    <span class="n">c_ptrs</span> <span class="o">=</span> <span class="n">c_ptr</span> <span class="o">+</span> <span class="n">stride_cm</span> <span class="o">*</span> <span class="n">offs_cm</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">stride_cn</span> <span class="o">*</span> <span class="n">offs_cn</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="__span-9-58"><a id="__codelineno-9-58" name="__codelineno-9-58" href="#__codelineno-9-58"></a>    <span class="n">c_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">offs_cm</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">M</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">offs_cn</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">)</span>
</span><span id="__span-9-59"><a id="__codelineno-9-59" name="__codelineno-9-59" href="#__codelineno-9-59"></a>    <span class="n">tl</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">c_ptrs</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">c_mask</span><span class="p">)</span>
</span><span id="__span-9-60"><a id="__codelineno-9-60" name="__codelineno-9-60" href="#__codelineno-9-60"></a>
</span><span id="__span-9-61"><a id="__codelineno-9-61" name="__codelineno-9-61" href="#__codelineno-9-61"></a>
</span><span id="__span-9-62"><a id="__codelineno-9-62" name="__codelineno-9-62" href="#__codelineno-9-62"></a><span class="k">def</span> <span class="nf">matmul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span><span id="__span-9-63"><a id="__codelineno-9-63" name="__codelineno-9-63" href="#__codelineno-9-63"></a>    <span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Incompatible dimensions, the weight matrix need to be packed&quot;</span>
</span><span id="__span-9-64"><a id="__codelineno-9-64" name="__codelineno-9-64" href="#__codelineno-9-64"></a>    <span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">(),</span> <span class="s2">&quot;Matrix A must be contiguous&quot;</span>
</span><span id="__span-9-65"><a id="__codelineno-9-65" name="__codelineno-9-65" href="#__codelineno-9-65"></a>    <span class="n">M</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-9-66"><a id="__codelineno-9-66" name="__codelineno-9-66" href="#__codelineno-9-66"></a>    <span class="n">_</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-9-67"><a id="__codelineno-9-67" name="__codelineno-9-67" href="#__codelineno-9-67"></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
</span><span id="__span-9-68"><a id="__codelineno-9-68" name="__codelineno-9-68" href="#__codelineno-9-68"></a>    <span class="n">grid</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">META</span><span class="p">:</span> <span class="p">(</span><span class="n">triton</span><span class="o">.</span><span class="n">cdiv</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">META</span><span class="p">[</span><span class="s1">&#39;BLOCK_SIZE_M&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">triton</span><span class="o">.</span><span class="n">cdiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">META</span><span class="p">[</span><span class="s1">&#39;BLOCK_SIZE_N&#39;</span><span class="p">]),</span> <span class="p">)</span>
</span><span id="__span-9-69"><a id="__codelineno-9-69" name="__codelineno-9-69" href="#__codelineno-9-69"></a>    <span class="n">matmul_kernel</span><span class="p">[</span><span class="n">grid</span><span class="p">](</span>
</span><span id="__span-9-70"><a id="__codelineno-9-70" name="__codelineno-9-70" href="#__codelineno-9-70"></a>        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span>
</span><span id="__span-9-71"><a id="__codelineno-9-71" name="__codelineno-9-71" href="#__codelineno-9-71"></a>        <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
</span><span id="__span-9-72"><a id="__codelineno-9-72" name="__codelineno-9-72" href="#__codelineno-9-72"></a>        <span class="n">a</span><span class="o">.</span><span class="n">stride</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">a</span><span class="o">.</span><span class="n">stride</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span><span id="__span-9-73"><a id="__codelineno-9-73" name="__codelineno-9-73" href="#__codelineno-9-73"></a>        <span class="n">b</span><span class="o">.</span><span class="n">stride</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">b</span><span class="o">.</span><span class="n">stride</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span><span id="__span-9-74"><a id="__codelineno-9-74" name="__codelineno-9-74" href="#__codelineno-9-74"></a>        <span class="n">c</span><span class="o">.</span><span class="n">stride</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">stride</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span><span id="__span-9-75"><a id="__codelineno-9-75" name="__codelineno-9-75" href="#__codelineno-9-75"></a>    <span class="p">)</span>
</span><span id="__span-9-76"><a id="__codelineno-9-76" name="__codelineno-9-76" href="#__codelineno-9-76"></a>    <span class="k">return</span> <span class="n">c</span>
</span></code></pre></div>
<h3 id="_10">ä»£ç è§£æ<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>ç¡®å®šåˆ†å—ä½ç½®</strong></li>
</ol>
<p>ç®—å­é¦–å…ˆç¡®å®šæ¯ä¸ªçº¿ç¨‹å—è´Ÿè´£çš„è¾“å‡ºçŸ©é˜µçš„å—ï¼ˆtileï¼‰ï¼š</p>
<ul>
<li><code>pid</code> æ˜¯æ¯ä¸ªçº¿ç¨‹å—çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä½¿ç”¨ <code>tl.program_id(axis=0)</code> è·å¾—ã€‚</li>
<li>ç½‘æ ¼è¢«åˆ†æˆä¸€ç»„çº¿ç¨‹å—ï¼ˆ<code>GROUP_SIZE_M</code>ï¼‰ã€‚æ¯ä¸ªç»„å¤„ç†è¾“å‡ºçŸ©é˜µçš„ä¸€éƒ¨åˆ†ã€‚</li>
<li><code>pid_m</code> å’Œ <code>pid_n</code> æ˜¯åˆ†å—åœ¨ M å’Œ N ç»´åº¦ä¸Šçš„åæ ‡ï¼Œåˆ†åˆ«è¡¨ç¤ºã€‚</li>
<li>
<p>è®¡ç®—åç§»é‡ï¼ˆ<code>offs_am</code>ã€<code>offs_bn</code>ã€<code>offs_k</code>ï¼‰ä»¥ç¡®å®šæ¯ä¸ªå—ä¸­çš„çº¿ç¨‹å°†å¤„ç†çŸ©é˜µ A å’Œ B çš„å“ªäº›å…ƒç´ ã€‚</p>
</li>
<li>
<p><strong>åŠ è½½å’Œè®¡ç®—åˆ†å—</strong></p>
</li>
</ul>
<p>ç®—å­ä½¿ç”¨å¾ªç¯ä»¥ <code>BLOCK_SIZE_K</code> çš„å—å¤§å°è¿­ä»£ K ç»´åº¦ã€‚å¯¹äºæ¯ä¸ªå—ï¼š</p>
<ul>
<li><strong>åŠ è½½åˆ†å—</strong>ï¼šä»å…¨å±€å†…å­˜åŠ è½½çŸ©é˜µ A å’Œ B çš„åˆ†å—ã€‚</li>
<li><strong>è§£åŒ…çŸ©é˜µ B</strong>ï¼šç®—å­å‡è®¾çŸ©é˜µ B æ˜¯ä½¿ç”¨ <code>int8</code> å€¼æ‰“åŒ…çš„ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªå…ƒç´ å®é™…ä¸Šä»£è¡¨å››ä¸ªè¾ƒå°çš„å€¼æ‰“åŒ…æˆä¸€ä¸ªå­—èŠ‚ã€‚è§£å‹è¿‡ç¨‹å‘ç”Ÿåœ¨å¾ªç¯å†…ï¼š<ul>
<li>ä»å…¨å±€å†…å­˜åŠ è½½ <code>b_uint8</code> ä½œä¸ºæ‰“åŒ…çš„ <code>int8</code>ã€‚</li>
<li>è§£å‹æ¯ä¸ªæ‰“åŒ…çš„å€¼ä»¥è·å¾—ç”¨äºè®¡ç®—çš„å®é™…æƒé‡å€¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç‚¹ç§¯</strong>ï¼šå†…æ ¸è®¡ç®—ä»çŸ©é˜µ A å’Œ B åŠ è½½çš„åˆ†å—çš„ç‚¹ç§¯ï¼Œå¹¶å°†ç»“æœç´¯ç§¯åˆ° <code>accumulator</code> ä¸­ã€‚<code>accumulator</code> å­˜å‚¨è¾“å‡ºçŸ©é˜µ C çš„åˆ†å—çš„éƒ¨åˆ†ç»“æœã€‚</p>
</li>
<li>
<p><strong>å­˜å‚¨ç»“æœ</strong></p>
</li>
</ul>
<p>åœ¨å¤„ç†å®Œæ²¿ç€ K ç»´åº¦çš„æ‰€æœ‰åˆ†å—ä¹‹åï¼Œå­˜å‚¨åœ¨ <code>accumulator</code> ä¸­çš„æœ€ç»ˆç»“æœè¢«è½¬æ¢ä¸º <code>float16</code>ï¼Œå¹¶å†™å›åˆ°å…¨å±€å†…å­˜ä¸­çŸ©é˜µ C çš„ç›¸åº”åˆ†å—ã€‚å†™å…¥è¿‡ç¨‹ä½¿ç”¨æ©ç æ¥ç¡®å®šå†…å­˜è¾¹ç•Œï¼Œä»¥ç¡®ä¿åªå†™å…¥æœ‰æ•ˆå…ƒç´ ã€‚</p>
<p>è¦è·å–ä»£ç çš„æ›´è¯¦ç»†è§£é‡Šï¼Œè¯·æŸ¥çœ‹è¿™ä¸ª<a href="https://github.com/linkedin/Liger-Kernel/pull/195/files">PR</a>ã€‚</p>
<h3 id="_11">åŸºå‡†æµ‹è¯•<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>æˆ‘ä»¬å¯¹æˆ‘ä»¬çš„ç®—å­è¿›è¡Œäº†åŸºå‡†æµ‹è¯•ï¼Œä¸ä½¿ç”¨ <code>@torch.compile</code> è§£å‹æƒé‡ç„¶ååœ¨ BF16 ç²¾åº¦ä¸‹æ‰§è¡ŒçŸ©é˜µä¹˜æ³•çš„æ–¹æ³•è¿›è¡Œäº†å¯¹æ¯”ï¼Œå‘ç°ä¸¤ç§æ–¹æ³•çš„æ€§èƒ½å‡ ä¹ç›¸åŒã€‚ä¸ºäº†ç¡®ä¿å‡†ç¡®çš„åŸºå‡†æµ‹è¯•ï¼Œæˆ‘ä»¬åœ¨ 2000 æ¬¡è¿­ä»£ä¸­æ‰§è¡Œäº†çŸ©é˜µä¹˜æ³•æ“ä½œï¼Œå¹¶åœ¨æœ€å 1000 æ¬¡è¿­ä»£ä¸­è®¡ç®—å¹³å‡æ—¶é—´ï¼Œä»¥æ¶ˆé™¤ä¸åˆå§‹åŠ è½½æˆ–ç¼–è¯‘ç›¸å…³çš„ä»»ä½•ä½æ•ˆæ€§ã€‚ä¸‹é¢æ˜¯æ˜¾ç¤ºåŸºå‡†æµ‹è¯•ç»“æœçš„å›¾è¡¨ã€‚æˆ‘ä»¬è¿˜æµ‹è¯•äº†å„ç§çŸ©é˜µå¤§å°ï¼Œå…¶ä¸­ x è½´è¡¨ç¤ºå¯¹æ•°å°ºåº¦ä¸Šçš„ä¹˜æ³•æ¬¡æ•°ï¼Œy è½´æ˜¾ç¤ºå¹³å‡æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/without_bitblas.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/without_bitblas.png" alt="Tritonç®—å­å¯¹æ¯”torch.compile" style="width: 100%;"/></a>
  <figcaption>Tritonç®—å­å¯¹æ¯”torch.compile</figcaption>
</figure>

<p>æˆ‘ä»¬è¿˜å°è¯•ä½¿ç”¨ BitBlasï¼Œè¿™æ˜¯ä¸€ä¸ªæ—¨åœ¨ä½¿ç”¨æ··åˆç²¾åº¦æ‰§è¡ŒçŸ©é˜µè¿ç®—çš„è½¯ä»¶åº“ã€‚å®ƒé€šè¿‡å…è®¸åœ¨è¾ƒä½ç²¾åº¦æ ¼å¼ï¼ˆå¦‚ INT8ã€INT4ï¼Œç”šè‡³ INT2ï¼‰è€Œä¸æ˜¯ä¼ ç»Ÿçš„ FP32 æˆ– FP16 æ ¼å¼ä¸­è¿›è¡Œè®¡ç®—ï¼Œæ¥å¸®åŠ©ä¼˜åŒ–è¿™äº›æ“ä½œã€‚</p>
<p>åŸºå‡†æµ‹è¯•ç»“æœä»¤äººé¼“èˆï¼Œå¦‚å›¾æ‰€ç¤ºï¼ŒBitBlas åœ¨ä½ç²¾åº¦ä¸‹ä¼˜äºæˆ‘ä»¬çš„è‡ªå®šä¹‰å†…æ ¸å’ŒTorchçš„ <code>matmul</code> å‡½æ•°ã€‚</p>
<figure style="text-align: center;">
  <a class="glightbox" href="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/with_bitblas.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/1.58llm_extreme_quantization/with_bitblas.png" alt="Bitblas æµ‹è¯•" style="width: 100%;"/></a>
  <figcaption>Bitblasæµ‹è¯•</figcaption>
</figure>

<p>ç„¶è€Œï¼Œåœ¨æ¨¡å‹åŠ è½½è¿‡ç¨‹ä¸­ï¼ŒBitBlas éœ€è¦ç¼–è¯‘é€‚åˆæƒé‡çŸ©é˜µå½¢çŠ¶çš„å†…æ ¸ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨æœ¬åœ°ä»£ç åº“ä¸­ï¼Œè¿™å¯èƒ½ä¼šå¢åŠ åˆå§‹åŠ è½½æ—¶é—´ã€‚</p>
<h2 id="_12">ç»“è®º<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<p>æ€»ä¹‹ï¼Œéšç€å¤§å‹è¯­è¨€æ¨¡å‹çš„ä¸æ–­æ‰©å±•ï¼Œé€šè¿‡é‡åŒ–æ¥å‡å°‘å®ƒä»¬çš„è®¡ç®—éœ€æ±‚è‡³å…³é‡è¦ã€‚æœ¬åšæ–‡æ¢è®¨äº† 1.58 ä½é‡åŒ–çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä½¿ç”¨äº†ä¸‰å€¼æƒé‡ã€‚è™½ç„¶åœ¨ 1.58 ä½è¿›è¡Œé¢„è®­ç»ƒæ¨¡å‹æ˜¯èµ„æºå¯†é›†å‹çš„ï¼Œä½†æˆ‘ä»¬å·²ç»è¯æ˜ï¼Œé€šè¿‡ä¸€äº›æŠ€å·§ï¼Œå¯ä»¥å°†ç°æœ‰æ¨¡å‹å¾®è°ƒåˆ°è¿™ä¸ªç²¾åº¦æ°´å¹³ï¼Œå®ç°é«˜æ•ˆçš„æ€§èƒ½è€Œä¸ç‰ºç‰²å‡†ç¡®æ€§ã€‚é€šè¿‡ä¸“é—¨çš„å†…æ ¸ä¼˜åŒ–æ¨ç†é€Ÿåº¦ï¼ŒBitNet ä¸ºä½¿å¤§å‹è¯­è¨€æ¨¡å‹æ›´å…·å®ç”¨æ€§å’Œå¯æ‰©å±•æ€§æ‰“å¼€äº†æ–°çš„å¯èƒ½æ€§ã€‚</p>
<h2 id="_13">è‡´è°¢<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h2>
<p>æˆ‘ä»¬è¦è¡·å¿ƒæ„Ÿè°¢ Leandro von Werraã€Thomas Wolf å’Œ Marc Sun åœ¨æ•´ä¸ªé¡¹ç›®ä¸­æä¾›çš„å®è´µå¸®åŠ©å’Œè§è§£ã€‚æˆ‘ä»¬è¿˜è¦æ„Ÿè°¢ Omar Sanseviero å’Œ Pedro Cuenca åœ¨å®Œå–„è¿™ç¯‡åšæ–‡æ–¹é¢çš„è´¡çŒ®ï¼Œå¸®åŠ©æˆ‘ä»¬æ¸…æ™°æœ‰æ•ˆåœ°å‘äººå·¥æ™ºèƒ½ç¤¾åŒºä¼ è¾¾æˆ‘ä»¬çš„å‘ç°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¦æ„Ÿè°¢GeneralAIå›¢é˜Ÿåœ¨BitNeté¡¹ç›®ä¸Šçš„å¼€åˆ›æ€§å·¥ä½œã€‚ä»–ä»¬çš„ç ”ç©¶å¯¹æˆ‘ä»¬çš„åŠªåŠ›å…·æœ‰åŸºç¡€æ€§æ„ä¹‰ï¼Œæˆ‘ä»¬ç‰¹åˆ«æ„Ÿè°¢ä»–ä»¬åœ¨è®ºæ–‡ä¸­æä¾›çš„æ¸…æ™°å‡†ç¡®çš„æ•°æ®ã€‚</p>
<h2 id="_14">æ›´å¤šèµ„æº<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h2>
<ol>
<li>H. Wang et al., <em>BitNet: Scaling 1-bit Transformers for Large Language Models</em>. <a href="https://arxiv.org/pdf/2310.11453">arxiv paper</a></li>
<li>S. Ma et al., <em>The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits</em>. <a href="https://arxiv.org/pdf/2402.17764">arxiv paper</a></li>
<li>S. Ma et al., <em>The Era of 1-bit LLMs: Training Tips, Code and FAQ</em>. <a href="https://github.com/microsoft/unilm/blob/master/bitnet/The-Era-of-1-bit-LLMs__Training_Tips_Code_FAQ.pdf">link</a></li>
<li>RJ. Honicky, <em>Are All Large Language Models Really in 1.58 Bits?</em>. <a href="https://learning-exhaust.hashnode.dev/are-all-large-language-models-really-in-158-bits">blogpost</a></li>
<li>L. Mao, <em>CUDA Matrix Multiplication Optimization</em>. <a href="https://leimao.github.io/article/CUDA-Matrix-Multiplication-Optimization/">blogpost</a></li>
<li><em>Tutorial: OpenCL SGEMM tuning for Kepler</em>. <a href="https://cnugteren.github.io/tutorial/pages/page4.html">link</a></li>
<li><em>CUDAMODE</em>. <a href="https://github.com/cuda-mode">github</a>, <a href="https://www.youtube.com/channel/UCJgIbYl6C5no72a0NUAPcTA">youtube</a></li>
<li>Wen-mei W. Hwu, David B. Kirk, Izzat El Hajj, <em>Programming Massively Parallel Processors : A Hands-on Approach</em></li>
</ol>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 1, 2024</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 1, 2024</span>
  </span>

    
    
      
  
  <span class="md-source-file__fact">
    <span class="md-icon" title="Contributors">
      
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 5.5A3.5 3.5 0 0 1 15.5 9a3.5 3.5 0 0 1-3.5 3.5A3.5 3.5 0 0 1 8.5 9 3.5 3.5 0 0 1 12 5.5M5 8c.56 0 1.08.15 1.53.42-.15 1.43.27 2.85 1.13 3.96C7.16 13.34 6.16 14 5 14a3 3 0 0 1-3-3 3 3 0 0 1 3-3m14 0a3 3 0 0 1 3 3 3 3 0 0 1-3 3c-1.16 0-2.16-.66-2.66-1.62a5.54 5.54 0 0 0 1.13-3.96c.45-.27.97-.42 1.53-.42M5.5 18.25c0-2.07 2.91-3.75 6.5-3.75s6.5 1.68 6.5 3.75V20h-13zM0 20v-1.5c0-1.39 1.89-2.56 4.45-2.9-.59.68-.95 1.62-.95 2.65V20zm24 0h-3.5v-1.75c0-1.03-.36-1.97-.95-2.65 2.56.34 4.45 1.51 4.45 2.9z"/></svg>
      
    </span>
    <nav>
      
    </nav>
  </span>

    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! Help us improve this page by using our <a href="..." target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../big-data/" class="md-footer__link md-footer__link--prev" aria-label="Previous: å¤§æ•°æ®">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                å¤§æ•°æ®
              </div>
            </div>
          </a>
        
        
          
          <a href="../2023-in-llms/" class="md-footer__link md-footer__link--next" aria-label="Next: 2023, å¼€æºå¤§æ¨¡å‹ä¹‹å¹´">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                2023, å¼€æºå¤§æ¨¡å‹ä¹‹å¹´
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020 - 2024 FastX-AI
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
    
    
    
    <a href="https://fastx-ai.com" target="_blank" rel="noopener me" title="fastx-ai" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.5 102.5 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5m-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:x.stark.dylan@gmail.com" target="_blank" rel="noopener" title="send me an email" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 112c-8.8 0-16 7.2-16 16v22.1l172.5 141.6c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16zM48 212.2V384c0 8.8 7.2 16 16 16h384c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0zM0 128c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64z"/></svg>
    </a>
  
    
    
    
    
    <a href="/contact" target="_blank" rel="noopener" title="contact us" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 4H7a5 5 0 0 0-5 5v11h18a2 2 0 0 0 2-2V9a5 5 0 0 0-5-5m-7 14H4V9a3 3 0 0 1 3-3 3 3 0 0 1 3 3zm9-3h-2v-2h-4v-2h6zM9 11H5V9h4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.prune", "content.action.edit", "content.code.copy", "content.code.annotate", "content.tabs.link", "content.tooltips", "header.autohide", "announce.dismiss", "search.suggest", "search.highlight", "search.share", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
<!-- Add scripts that need to run before here -->

      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
<!-- Add scripts that need to run afterwards here -->

  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>